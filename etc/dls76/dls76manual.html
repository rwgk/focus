<html>

<head>
<title>DLS-76 Manual (most of)</title>
</head>

<body>
<p> This is - after nearly 20 years - the <em>very first</em>
    on-line version of the DLS-76 manual. We wish to
    acknowledge our scanner for re-typing the text.
    Unfortunately both, the HTML standard and our OCR software,
    were not enough advanced to include pictures and formulae
    automatically. Please enjoy what you get. Just another
    20 years of breath-taking development in information technologies
    and we will proudly present pictures and formulae, too.
<p> For more information go to the
    <a href="http://kristall.erdw.ethz.ch/xrs">XRS page</a>.
<p> Z&uuml;rich, May 1995
<hr>

<pre>





                            <strong>DLS-76</strong>





         A PROGRAM FOR THE SIMULATION OF CRYSTAL STRUCTURES


                     BY GEOMETRIC REFINEMENT





                              by

            Ch. Baerlocher, A. Hepp and W.M. Meier






                          AUGUST 1977

                INSTITUTE OF CRYSTALLOGRAPHY
                    AND PETROGRAPHY, ETH
                      SONNEGGSTRASSE 5
                        8092 ZUERICH
                        SWITZERLAND

</pre><hr><pre>






                    Revised version, March 1978





Address for copies of DLS-76 (CDC or IBM version) and inquiries
regarding the program:


        Dr. Ch. Baerlocher
        Institute of Crystallography
        and Petrography, ETH
        Sonneggstrasse 5
        8092 Zuerich, Switzerland

</pre><hr><pre>





                           P R E F A C E



DLS-76 is the successor of the original distance least
squares program DLS by VILLIGER (1969). It is a much extended
and revised version of DLS-74, a preliminary program set up by
GUIGAS (1975) at the University of Karlsruhe, BRD. DLS-76 in-
corporates all the features (such as linear constraints etc.)
which have been developed and used in various modified versions
since 1969. The present program is written in FORTRAN IV and
has been extensively tested on the CDC 6400/6500 at ETH Zuerich.
This program is distributed with the disclaimer that it is to
be used at your own risk. Comments will be much appreciated.


We want to thank many of our friends and colleagues, in parti-
cular Prof. W. Baur, Drs. V. Gramlich, B. Guigas, S.L. Lawton,
and E.L. Wu for helpful discussions and various contributions.
We also want to express our appreciation to the Schweizerischer
Nationalfonds and ETH Zuerich for financial aid.


</pre><hr><pre>


CONTENTS
--------



INTRODUCTION                                    1- 1 to 1- 3


PROGRAM DESCRIPTION
  Program Features and Applications             2- 1 to 2- 4
  Program Flow and Operations                   2- 5 to 2- 9


DATA INPUT
  Function and Format of Data Cards             3- 1 to 3-29
  Parameter File                                3-31


EXAMPLES                                        4- 1 to 4-16


GLOSSARY OF SYMBOLS
  Control Integers and Single Variables         5- 1 to 5- 3
  Arrays                                        5- 3 to 5- 8


FORMULAE                                        6- 1 to 6- 8


REFERENCES                                      7- 1 to 7- 2


PROGRAM LISTING                                 8- 1 to 8-39


</pre><hr><pre>
                                                               1-1

1. INTRODUCTION
---------------


For a great many crystal structures interatomic distances and
bond angles can be predicted within fairly narrow limits. For
the present purpose, bond angles are conveniently expressed
in terms of bonded and non-bonded distances. Especially for
framework type structures the total number of predictable
interatomic distances as a rule exceeds the number of ad-
justable atom coordinates or positional parameters. In the
2-dimensional (hypothetical) example shown in Fig. 1 a total
of at least 10 crystallographically non-equivalent distances(1
would presumably be predictable and could then be used to
determine the 6 positional parameters of the structure since
interatomic distances are a function only of the atom coordi-
nates and the unit cell constants(2. It is evident that in
such a case the positional parameters can be computed from
prescribed interatomic distances Dj0 by a least-squares pro-
cedure minimizing the residual function


                        FORMULA


in which Djm,n is the calculated distance of type j between
atoms m and n, and Wj is the weight ascribed to the inter-
atomic distance of type j. This method of geometric or DLS
refinement, first described in detail by MEIER and VILLIGER
(1969), produces optimized model structures with respect to




(1  5 M-X and 5 X-X distances

(2  The distance Dm,n between a pair of atoms m and n is
                        FORMULA


</pre><hr><pre>
                                                               1-2





                               Figure 1


prescribed interatomic distances (or ratios of interatomic
distances) and unit cell constants for a given space group.
Only very approximate starting coordinates are needed.
Possible variables are atom coordinates and/or unit cell
constants (or functions thereof). The weight w  of each
error equation is normally based on bonding considerations
(cf. BAUR, 1977) or observed variations in bond length values.


Applications of DLS include

(i)   Evaluation of hypothetical structures and preliminary
      refinement of trial structures. This is of particular use in
      structure determinations based on powder data (cf. BARRER and
      VILLIGER, 1969).


</pre><hr><pre>
                                                               1-3

(ii)  Study of geometrical constraints in framework type structures
      and determination of probable space group symmetry (cf. MEIER and
      VILLIGER, 1969).

(iii) Analysis and refinement of pseudosymmetric crystal structures
      (GRAMLICH and MEIER, 1971; TILLMANNS, GEBERT and BAUR, 1973;
      DOLLASE and BAUR, 1976).

(iv)  Interpretation of symmetrized and of superimposed structures
      (MEIER, 1973).

(v)   Simulation of the response of complex crystal structures to
      changes in pressure and/or temperature, as well as estimation of
      likely changes in cell dimensions on isostructural substitution
      (DEMPSEY and STRENS, 1976; KHAN, 1976).


Hard constraints are imposed upon the error equations by
crystallographic symmetry elements. Other subsidiary conditions are
encountered (e.g.) in analysis of pseudosymmetric structures. To
ensure that a DLS model structure with reduced symmetry (hettotype
or H-type structure) remains compatible with an experimentally
determined structure of idealized high symmetry (aristotype or A-
type structure) subsidiary conditions of the form


                        FORMULA


are applied where #xi are the displacements which generate the H-
type structure from the A-type, d(i) the pseudosymmetry operations
and n is the index of the subgroup relation (MEIER and VILLIGER,
1969). The weights of these soft constraints (which are treated like
observational equations according to WASER, 1963) are based on the
standard deviations of the coordinates of the A-type structure.


</pre><hr><pre>
                                                               2-1

2. PROGRAM DESCRIPTION
----------------------

In the first part of this chapter a general description of the
features of the program is given. In the second part the more
specific operation and program flow is described together with
information which may be helpful when installing the program on
another computer.


2.1 Program features and applications

The basic features of the present program as compared to previous
versions are:

- Simplified and flexible data input

The input data are kept to a minimum and are checked as far as
possible. In case an error is detected detailed error messages are
printed. However, the program is stopped only after all input cards
have been processed. Prescribed distances which happen to be
symmetrically equivalent are eliminated by the program. For
tetrahedral framework structures only the connectivity of the atoms
must be specified and the program generates all error equations (T-
O, O-O, and T-T distances) itself. (See description of TETCON card).


- Random atom coordinates

To further simplify the data input atom coordinates obtained from a
random number generator can be used instead of punched coordinates.
As shown by GUIGAS (1975) DLS computations converge in most
instances even when random coordinates are used as starting
parameters, in which case some 10 to 40 cycles are usually required.

Random coordinates have two further advantages: (1) By testing
around 5 to 10 different random parameter sets it is possible that
the program may find two or more non-equivalent solutions which
otherwise would remain undetected.


</pre><hr><pre>
                                                               2-2

(2) Estimated starting parameters frequently tend to correspond to a
higher symmetry than the one actually desired. This results in some
very high correlations and the refinement can be inhibited or a
solution will only be found in the higher symmetry. The same
situation arises when a symmetry reduction is performed. In this
case random coordinates should be used or the trick used in Example
2 (with NATOM cards) may be applied.


- Refinement procedures

Basically the program uses the least squares method. However, there
is a choice of two different modes, the Newton-Raphson and the
Gauss-Newton procedures. GUIGAS (1975) investigated the convergence
behavior of these two procedures and his recommendations are as
follows:

In the Newton-Raphson procedure the first and the second derivatives
of the distances are calculated. Normally this leads to a faster
convergence. It is recommended for runs with invariant cell
parameters, when using random starting coordinates, and when the
other procedure does not converge. The Gauss-Newton procedure is the
classical one, in which only the first derivatives are calculated.
It is employed with advantage when cell parameters are also refined,
when linear constraints are used, and when the Newton-Raphson method
fails.


- Refinement of cell parameters and of prescribed distances
  (constant ratio or R refinement)

In addition to the atom coordinates the cell parameters can also be
varied. This is useful for the determination of ideal cell
parameters. In the constant ratio refinement the prescribed
distances are also refined but their ratios are kept constant. In


</pre><hr><pre>
                                                               2-3

this way a model with ideal polyhedra will result.Normally these
refinements should only be tried using coordinates which have
already been partially refined.


- Linear restrictions

The program also allows for linear restrictions on the coordinates
which arise when the symmetry for the DLS refinement has been
reduced. These restrictions can be included as soft and/or hard
constraints and are simply punched on cards as equations. This
application is illustrated in Example 2.


- Adjustment of prescribed interatomic distances (APID)

It has been shown (cf. BROWN, GIBBS and RIBBE, 1969) that in
framework silicates e.g. T-O distances depend to some extent on the
T-O-T angle. Such relationships can be included as polynominal
functions. The program will adjust the prescribed interatomic
distances after each set of refinement cycles according to this
function.


- Calculation of approximate eigenvalues of the matrix

If the refinement has converged, the approximate eigenvalues of the
matrix are printed for the last cycle. In the case of the Newton-
Raphson procedure they are to be interpreted as follows:

- All eigenvalues are positive: A minimum has been found.

- All eigenvalues are negative: This corresponds to a maximum in the
  function and the parameters do not represent a proper solution of
  the least squares problem.

- Positive and negative eigenvalues are present: This indicates a
  saddle point of the function and is again not an actual solution.

- Some eigenvalues are extremely small (approaching zero): In this
  case no statement about the nature of the solution can be made.


</pre><hr><pre>
                                                               2-4

- Difference vectors of reference structure and DLS model

Frequently, one may wish to compare the DLS model with the
coordinates obtained by X-ray analysis (reference structure). If the
coordinates of the latter are supplied as starting values DLS-76
will calculate the difference vectors between the two structures and
their magnitudes (in A). In space groups with no fixed origin one or
more coordinates of an arbitrarily chosen atom have to be fixed in
the DLS-refinement. In these cases the deviations between the DLS
model and the reference structure are minimized by translating the
DLS model along the respective axes.


- Parameter file

In order to divide a large job into several smaller jobs, the
refined parameters of each cycle can be written on a parameter file.
This file can also be used to select "prerefined" sets of
coordinates which have resulted from a run with different sets of
random starting coordinates.


- Additional features

There are a number of additional features in the program for special
applications (e.g. variable and fixed damping factors, convergence
test, tests whether distances lie within specified limits etc.).
Information on these can be found in the description of the data
input.


</pre><hr><pre>
                                                               2-5

2.2 Program flow and operations

This part is intended for users who would like to understand the
detailed operation of the program and who may want to modify some
parts of it. The general outlay of the program and the function of
some of the more important subroutines will be described here.
Numerous comment cards are included in the source deck which
describe in detail the specific operations performed.


General

The standard version is dimensioned for

        100 atoms (independent and dependent)
        200 distances
        150 variables

The approximate memory requirements are therefore as follows

        program code,
        includinq system routines       ca. 16K without I/O buffers
        arrays (labeled common)         ca. 13K
        matrix array (blank common)         11.5K

adding up to a total of about 40K without I/O buffers.

The program uses 3 machine specific functions, namely

        DATE(DA)        in the main program for the current
                        date.
                        The date is printed in subroutine KOPF

        SECOND(CP)      in the main program which gives the CP
                        time since start of job

        RANF(Y)         in subroutine DATIN which returns a
                        random number between 0 and 1 (see
                        comment cards in DATIN)

        (CA, CP and Y are all dummy arguments)


A simplified flow chart giving an overview of the program is shown
in Fig. 2 on the next page. The calling sequence of the subroutines
can be readily seen in this chart. The main program, described below


</pre><hr><pre>
                                                               2-6

               Simplified Flow Chart of DLS-76






                                    Figure 2

</pre><hr><pre>
                                                               2-7

in more detail, is marked with heavy lines. The subroutine calls are
indicated by dotted lines. The subroutine names are given and their
function is briefly explained. For simplicity only the more
important subroutine calls are included.


Main program

As indicated in the flow chart this routine controls the program
flow by calls to different subroutines according to the control
flags set by the user. The parameter file is also written by this
program but only minor calculations (such as R-values) are
performed.


Subroutine DATIN

All input data is handled by this routine. The cards are read twice,
first to determine their function and a second time to read the
parameters. In the CDC version this is done by means of the DECODE
statement. The input parameters and the dimension bounds are
checked, error messages printed, index tables built up and some
preliminary calculations performed. DATIN also contains the random
coordinate generator and for this reason it is called each time a
new set of coordinates is generated. The program is stopped by this
routine when a FINISH card is encountered.


Subroutine SYMOP

The coded symmetry information on the ATOM cards (special positions)
and the SYMEQ cards are decoded by this routine. The homogeneous,
non-translational part is then stored in arrays B(K,K,N) and
SIGN(K,K,NEQU) for the ATOM card number N and SYMEQ card number
NEQU, respectively. Similarly BI(K,N) contains the invariant part of
the restriction and SI(K,NEQU) the translational part of the
symmetry transformation. SYMOP also calculates all dependent
coordinates from the independent ones according to these symmetry
transformations.


</pre><hr><pre>
                                                               2-8

Subroutine SETUP

SETUP is called only in case of tetrahedral structures when TETCON
cards are supplied. Internally the connectivity of each tetrahedron
is stored in ICON(NZA,ll). The routine generates all distances
around the central atom NZA (i.e. T-O, O-O and T-T distances),
evaluates their prescribed values using the information of the
BONDIS cards and eliminates equivalent distances. It sets up the
array MD(NZA,18) which contains the internal number of each distance
around atom NZA in the order described in the Glossary of Symbols.
This array is used in subroutine APID.


Subroutine EQUI

This routine is called to test if two distances are symmetrically
equivalent. The test is done in the following way. First the
calculated values of the two distances are compared. If the
difference is larger than 10-8, the distances are considered as not
equivalent. If they do agree within this limit, artificial shifts
are applied to the atom parameters and the resulting distances are
compared once more. If they still agree the distances are considered
equivalent.


Subroutine DATOUT

The checked input data, i.e. the program control flags and the
initial parameters (cell constants, atom coordinates, linear
restrictions etc.) are printed by this routine. It has also a second
entry (PAREX) which is called at the end of a run to print the final
atom parameters in a special format.


Subroutine DISDER

The matrix and vector of the equations to be solved in each
iteration cycle (the normal equations in the Gauss-Newton procedure)
are set up by this routine. This involves mainly the calculation of
the distances and their derivatives. The more important equations on
which the calculations are based are derived in chapter 6.


</pre><hr><pre>
                                                               2-9

Subroutine MATOUT

This routine may be called to print the matrix and vector set up by
subroutine DISDER. It is also used to calculate and print the
correlation matrix, the estimated standard deviations (in the case
of the Gauss-Newton procedure) and to print the approximate
eigenvalues.


Subroutine INVERT and INCH

These two routines are used to calculate the inverse matrix. They
are based on the procedure for inverting large symmetric matrices
described by BUSING and LEVY (1962). As a further option a diagonal
matrix approximation is also available.


Subroutine APID

Subroutine APID adjusts in an iterative manner the prescribed
interatomic distances in tetrahedral structures according to a
function supplied on the BONDIS card. This function expresses the
dependence of the T-O distances on the observed T-O-T angle.
Prescribed O-O distances are calculated using an ideal tetrahedral
angle and the adjusted prescribed T-O distances. For calculating the
T-T distances the T-O-T angle supplied on the BONDIS card is used.
The routine also checks whether the observed distances are whithin
prescribed ranges and it can adjust the weight of "out of bound
distances" in order to force them back. The calculations are mainly
controlled by the array ICON(NZ,ll) which contains the connectivity
around each tetrahedral atom and the array MD(NZA,18) which contains
the number of all distances of each tetrahedron (see also Glossary
of Symbols). At the end a table is printed of all old and new
prescribed D 's and of the distances and angles in the model which
are of likely interest.


</pre><hr><pre>
                                                               3-1

3. DATA INPUT
-------------

The data input for DLS-76 is similar to that of the well-known
X-RAY-SYSTEM. Each data card has a name consisting of up to six
characters which determines its function. Currently the following
cards are accepted:


        1) TITLE                                Page 3- 3

        2) DLS-76                                    3- 5

        3) FACTOR                                    3- 7

        4) RANGES                                    3- 9

        5) CELL                                      3-11

        6) ATOM                                      3-13

        7) SYMEQ                                     3-15

        8) NOREF                                     3-17

        9) BONDIS                                    3-19

       10) TETCON                                    3-21

       11) DISTAN                                    3-23

       12) LINRES                                    3-25

       13) FILES                                     3-27

       14) END                                       3-29

       15) FINISH                                    3-29



With the exception of the FILES card, which can appear anywhere in
the deck, the data cards should be in the above order. Generally not
all these data cards will be used depending on the specific problem.


</pre><hr><pre>
                                                               3-2





</pre><hr><pre>
                                                               3-3
3.1 Function and Format of Data Cards


TITLE card      (optional)

          FORMAT (A6,18A4)

Cols.     Specified punching or function of the field
-----     -------------------------------------------
 1 -  5   TITLE
 7 - 78   Alphanumeric text which will be printed as
          heading on each page.






</pre><hr><pre>
                                                               3-4





</pre><hr><pre>
                                                               3-5
DLS-76 card

          FORMAT (A6,1X,I3,14I2,2X,5I2)

Cols.     Specified punching or function of the field
-----     -------------------------------------------
 1 -  6   DLS-76

 8 - 10   0/1/-N: use Gauss-Newton/use Newton-Raphson
          procedure/do first N cycles Gauss-Newton and
          finish with Newton-Raphson.
11 - 12   0/1: full matrix/diagonal matrix approximation.
13 - 14   0/N: do not/generate N sets of coordinates.
          Coordinates which are invariant are not gene-
          rated and the value supplied on the ATOM card
          is used.
15 - 16   0/N: do not/do make N cycles of distance
          refinement.
17 - 18   0/N: do not/do make N cycles of prescribed
          distance refinement (constant ratio refinement).
19 - 20   0/N: do not/do make N "APID" cycles (adjusted
          prescribed interatomic distances; see BONDIS
          and TETCON cards).
21 - 22   0/1: do not/do refine cell parameters

23 - 24   NC}
            } select parameters of cycle NC of APID cycle
            } NA of set number NS (if random coordinates
            } have been used), when reading from file
25 - 26   NA}
            } NFILEA (see FILES card).
27 - 28   NS}
29 - 30   0/1: do/do not make a convergence test (see
          FACTOR card).
31 - 32   0/N: do not/use variable damping factor for
          parameter shifts. (If in a particular cycle the
          agreement factor increases, all calculated
          parameter shifts will be halved N times or at
          least until the new agreement factor is smaller
          than the old one).


</pre><hr><pre>
                                                               3-6
DLS-76 card (Cont.)

Cols.     Specified punching or function of the field
-----     -------------------------------------------
33 - 34   0/1: do not/translate refined DLS model along
          x to minimise average deviations from initial
          coordinates. (This can only be used when the
          space group requires the x coordinate of an
          atom to be arbitrarily fixed.)
35 - 36   0/1: do not/translate refined DLS model along y.
37 - 38   0/1: do not/translate refined DLS model along z.
39 - 40   not used.

          Output control:
          ---------------
41 - 42   0/1: print parameters after first and final
          cycle/after each cycle.
43 - 44   0/1: print distances after first and final
          cycle/after each cycle.
45 - 46   0/1/2: do not/print matrix and vector of final
          cycle/of each cycle.
47 - 48   0/1/2/-1/-2: do not/print elements of corre-
          lation matrix of magnitude greater than the
          value specified on the FACTOR card after final
          cycle/after each cycle/print complete corre-
          lation matrix after final cycle/after each
          cycle.
          Note: when using Newton-Raphson procedure,
          the correlation matrix will only be calculated
          after the final cycle (using Newton-Gauss
          procedure). Each time the correlation matrix
          is calculated the estimated standard deviation
          of the atom coordinates will also be printed.
49 - 50   0/1/2: do not/write parameters of final cycle/
          write parameters of every cycle in card format
          on file NFILEA (see FILES card).


</pre><hr><pre>
                                                               3-7
FACTOR card (optional)

          FORMAT (A6,4X,3F5.2,I5,4E10.4)

Cols.     Specified punching or function of the field
-----     -------------------------------------------
 1 -  6   FACTOR
11 - 15   Damping factor to be applied to coordinate
          changes (default 1.0).
16 - 20   Damping factor for cell parameter changes
          (default 1.0).
21 - 25   Damping factor for changes of prescribed
          distances (default 1.0).
26 - 30   Starting number for random number generator
          (integer, default 0).
31 - 40   Factor for convergence test (default 0.0001).
          Refinement stops when all parameter changes are
          smaller than this value (see col. 30 on DLS-76
          card).
41 - 50   Multiply all weights of linear restrictions
          (see LINRES card) with this factor (default 1.0).
51 - 60   Multiply all weights of distances which are
          outside a given range with this factor (see
          RANGES card). The distances are only checked
          and this factor applied during an APID cycle
          (default 1.0).
61 - 70   Minimum absolute value for correlation matrix
          printout (default 0.5).
          Only the elements with an absolute value greater
          than this one will be printed if requested on
          column 48 of DLS-76 card.


Note: If the card is not supplied or a field is left blank,
      the default values are used.


</pre><hr><pre>
                                                               3-8





</pre><hr><pre>
                                                               3-9
RANGES card (optional)

          FORMAT (A6,4X,5F5.2)

With this card the range for each type of distance in a tetrahedral
framework can be defined. In an APID run the program will mark with
an asterisk those distances which fall outside this range and will
multiply the appropriate weight by the factor supplied on the FACTOR
card (col. 51-60). When this factor is not equal to 1.0, the
adjustment of the corresponding prescribed distance will be
suppressed.


Cols.     Specified punching or function of the field
-----     -------------------------------------------
 1 -  6   RANGES
11 - 15   Relative deviation of the T-O distance
          (default: 0.03)
16 - 20   Lower limit of O-T-O angle (default: 104.5)
21 - 25   Upper limit of O-T-O angle (default: 114.5)
26 - 30   Lower limit of T-O-T angle (default: 115.5)
31 - 35   Upper limit of T-O-T angle (default: 175.5)


Note: If the card is not supplied or the field is left blank,
      the default values are used.


</pre><hr><pre>
                                                               3-10





</pre><hr><pre>
                                                               3-11
CELL card

          FORMAT (A6,1X,A4,9X,6F10.4)

Cols.     Specified punching or function of the field
-----     -------------------------------------------
 1 -  4   CELL
 8 - 11   Axial system specification
          TRIC triclinic
          MON1 monoclinic, first setting
          MON2 monoclinic, second setting
          ORT orthorhombic
          TET tetragonal
          HEX hexagonal and trigonal
          RHO rhombohedral
          CUB cubic

21 - 30   lattice constant a in Angstroem units
31 - 40                    b
41 - 50                    c
51 - 60   angle #a in degrees or cos #a
61 - 70         #b            or cos #b
71 - 80         #g            or cos #g


Note: Only the parameters which are independent for a given
      system must be supplied, e.g. for the hexagonal system
      only a and c must be punched. Angles in degrees and
      cosines may be mixed. Values <1 are taken to be cosines.
      When the cell refinement is used, the symmetry
      restrictions on the cell parameters are set by the
      program.


</pre><hr><pre>
                                                               3-12





</pre><hr><pre>
                                                               3-13
ATOM card

          FORMAT (A6,1X,A6,3F8.5,2X,A3,1X,30A1)

Cols.     Specified punching or function of the field
-----     -------------------------------------------
 1 -  4   ATOM
 8 - 13   Atom label
14 - 21   x coordinate
22 - 29   y coordinate
30 - 37   z coordinate
40 - 42   Atom type (used in connection with BONDIS card)
44 - 73   If the atom is in a special position this field
          contains in free format the relation between
          the coordinates and/or the values of the fixed
          coordinate in a form similar to that commonly
          used (see below).


Note: For each symmetrically independent atom an ATOM card must
      be supplied. The atom type must be stated when the
      distances are specified by BONDIS and TETCON cards. Atoms
      which are symmetrically equivalent to these-atoms must be
      listed on SYMEQ cards.


Special positions:

Special positions are written in the form commonly used, e.g.
X,2X,Z whereby the following special rules must be observed:

   1) Coordinates considered as independent may not have a sign, a
      coefficient or an additional constant.

   2) An independent coordinate must appear at its correct place, e.g
      if Y is considered to be the independent coordinate, it must
      appear in the second position, after the first comma.

   3) Coordinates fixed by symmetry are punched in the form
      0,1/2,-3/4 etc. (and not as floating point numbers).


</pre><hr><pre>
                                                               3-14
ATOM card (Cont.)


The following symbols may be used to describe a special position:

        0 1 2 3 4 5 6 7 8 9 + - / , X Y Z

Blanks may be included anywhere, the comma is used as
separator.

Examples:

        X,2X-1,1/2      correct
        -X,1-2X,1/2     not allowed (violates rule 1)
        Y,2Y-1,1/2      not allowed (violates rule 2)
        X, -X,Z         correct
        2X, X,Z         not allowed (must be written
                        as 2Y,Y,Z)
        X,1/2X,Z        not allowed (no fractional
                        coefficients allowed)
        1/4, 1/4, 1/4   correct
        -Y, Y, 0        correct

The coordinate fields (cols. 14 - 37) of dependent or fixed
coordinates can be left blank.


</pre><hr><pre>
                                                               3-15
SYMEQ card

        FORMAT (A6,1X,A6,1X,A6,1X,40A1)

This card is used to specify symmetrically equivalent atoms
to the atoms supplied on ATOM cards.

Cols.     Specified punching or function of the field
-----     -------------------------------------------
 1 -  5   SYMEQ
 8 - 13   Atom label of independent atom (must appear
          on an ATOM card).
15 - 20   Atom label of the symmetrically equivalent
          atom to the atom in cols. 8-13. This label
          should not appear on an atom card.
22 - 61   Symmetry operation which transforms the
          independent atom (cols. 8-13) into the de-
          pendent atom (cols. 15-20).

The symmetry operation can be punched in free format in the same
manner as the special position on the ATOM card. The transformations
of the "general positions" in the International Tables are used
throughout (also for atoms in special positions). For atoms in
neighbouring cells additional translations must be added.

The following symbols may be used to state the symmetry operation:

        1 2 3 4 5 6 7 8 9 + - / , X Y Z

Blanks may be included anywhere, the comma is used as
separator. If a translation is a fraction of a cell edge,
it must be given as a quotient n/m, where n and m are
integers. The order of the terms is free, but additions of
translations are not performed, i.e. 1 + 1/4 must be
punched as 5/4 (see examples 2 and 3).


</pre><hr><pre>
                                                               3-16
SYMEQ card (Cont.)


Examples:  (all acceptable)

           -Z, X, -Y
           1/4+Z, 3/4+Y, 3/4-X
           Z+5/4, 3/4+Y, -X+3/4
           X-Y, -Y, 1/2+Z
           -X+1, -X+Y-1, Z-1/2


</pre><hr><pre>
                                                               3-17
NOREF card

Using this card parameters (atom coordinates, cell parameters) which
are not already invariant or dependent due to symmetry restrictions
(special positions) can be set constant. There are two formats for
this card, one for atom coordinates and one for cell parameters.

a) Atom coordinates

          FORMAT (A6,1X,A6,3(A1,2X))

Cols.     Specified punching or function of the field
-----     -------------------------------------------
 1 -  5   NOREF
 8 - 13   Atom label
     14   X, Y and/or Z, depending which coordinate
     17   should be kept invariant. X, Y and Z may be
     20   in any order.


If the cols. 14, 17 and 20 are left blank, all three coordinates are
set invariant. The card NOREF ATOMS, where ATOMS is punched in
columns 8-12 forces all coordinates invariant. In this case only
cell parameters and prescribed distances can be refined.


</pre><hr><pre>
                                                               3-18
NOREF card (Cont.)


b) Cell parameters

          FORMAT (A6,1X,A6,6A4)

Cols.     Specified punching or function of the field
-----     -------------------------------------------
 1 -  5   NOREF
 8 - 11   CELL
14 - 17   These fields may contain any of the following
18 - 21   words in any order:
22 - 25   Abbb, Bbbb, Cbbb, ALFA, BETA, GAMA (b=blank)
26 - 29
30 - 33   The parameters of the words appearing are set
34 - 37   invariant.


Note: A NOREF CELL card is only necessary in case of cell
      refinement when parameters not already invariant or
      dependent due to crystal system requirements are to
      be fixed.


</pre><hr><pre>
                                                               3-19
BONDIS card

          FORMAT (A6,1X,3(A3,1X),1X,4E10.4,3F5.0)

This card can be used in conjunction with the TETCON card
to specify the prescribed interatomic distances of tetrahedral
atoms and their weights. Additionally it is used to specify
the dependence of the T-O distance as a function of the
T-O-T angle. If an APID run (adjusted prescribed interatomic
distances) is requested (Col. 20 on DLS-76 card) this function
is used to calculate new prescribed distances according to the
T-O-T angles in the model.

The card contains the bond type, the distance function for this bond
type and the weights for the various types of distances. The
function has the form

        DO = A + B(TOT - #w) + C(TOT - #w)**2

where DO  : prescribed interatomic distance
      TOT : actual angle at bridging atom
      #w  : standard T-O-T angle (e.g. 145 Degree)
    A,B,C : constants


Cols.     Specified punching or function of the field
-----     -------------------------------------------
 1 -  5   BONDIS
 8 - 10   Atom type of tetrahedral atom (central atom)
12 - 14   Atom type of bridging atom
16 - 18   Atom type of outer T-atom
21 - 30   Parameter A of distance function
31 - 40             B
41 - 50             C
51 - 60   Angle #w in degrees (default 145 Degree)
61 - 65   Weight for T-O bond of this bond type
66 - 70   Weight for O-O bond
71 - 75   Weight for T-T bond


</pre><hr><pre>
                                                               3-20
BONDIS card (Cont.)


Note: This card must be supplied if the error equations
      (DISTAN-cards) are generated by the program from
      the connectivity specifications and of course always
      when an APID run is to be performed.





</pre><hr><pre>
                                                               3-21
TETCON card

          FORMAT (A6,7X,9(A6,1X))

This card serves to specify the connectivity of tetrahedral atoms,
i.e. the way these atoms are connected in the tetrahedral framework.
On one card the central atom and the atoms of its first and second
coordination are stated.

Together with the information from the BONDIS card, the program
generates all independent T-O, O-O and T-T distances and assigns the
proper prescribed distances and weights. This saves punching all
these DISTAN cards. However, distances generated in this way can
always be overwritten by supplying a DISTAN card, and, of course,
other distances can be added with DISTAN cards.

In an APID run the TETCON card supplies all the necessary
information for the calculation of the adjusted prescribed
interatomic distances of tetrahedral framework structures.


Cols.     Specified punching or function of the field
-----     -------------------------------------------
 1 -  6   TETCON
14 - 19   Label of the T-atom
21 - 26   Label of first bridging atom (O-atom)
28 - 33   Label of second,
35 - 40            third,
42 - 47        and fourth bridging atom
49 - 54   Label of outer T-atom bonded to first,
56 - 61                                   second,
63 - 68                                   third,
70 - 75                               and fourth
          bridging atom.


Note: All labels of atoms considered must appear either on an
      ATOM or a SYMEQ card.


</pre><hr><pre>
                                                               3-22
TETCON card (Cont.)


Special positions:

Only those T-O bonds which are symmetrically independent must be
specified. However, make sure that all O-atoms are punched which are
necessary for the specification of all independent O-O distances.
For each independent T-O bond the outer T-atom must also be given
(for the determination of bond type). Bonds or distances which are
symmetrically equivalent are eliminated by the program.





</pre><hr><pre>
                                                               3-23
DISTAN card

          FORMAT (A6,1X,2(A6,1X),2F10.5,A1,F10.5)

This is the standard card to specify an error equation. Each card
contains the label of two atoms, their prescribed distances and the
weight assigned to these distances. In addition a reference distance
can also be supplied in case a constant (distance) ratio refinement
is to be performed.


Cols.     Specified punching or function of the field
-----     -------------------------------------------
 1 -  6   DISTAN
 8 - 13   Atom label of first atom
15 - 20   Atom label of second atom
22 - 31   Prescribed interatomic distance between the
          two atoms. If the field is left blank, the
          value of the previous card is used.
32 - 41   Weight assigned to this distance. If the field
          is left blank, the weight will be taken as 1.0.
          However, if the distance field is also blank,
          the weight of the previous card will be used.
     42   Blank/any alphanumeric character: This pre-
          scribed distance is invariant/this prescribed
          distance will be refined in a constant ratio
          refinement. All prescribed distances having the
          same character in this field depend on the same
          reference distance. Their ratio to the reference
          distance will be kept constant during the re-
          finement (see example).
43 - 52   Reference distance. If this field is left blank
          (and column 42 is not blank) the prescribed
          distance for this card will be taken as re-
          ference distance, i.e. the distance ratio will
          be 1.0.


</pre><hr><pre>
                                                               3-24
DISTAN card  (Cont.)


Example  (with constant ratio refinement)

    DISTAN A1    A2     2.0     1.0     R 2.0
    DISTAN A1    A3     3.0     1.0     R 2.0
    DISTAN A1    A4
    DISTAN A1    A5     2.5     1.0     R 2.0


All four prescribed distances will be varied, but not independently
because all cards have the same character R in column 42 (the third
card has the same values as the second card). According to these
specifications the ratio of distance 2 to distance 1 and distance 3
to distance 1 is always 3:2 and the ratio of distance 4 to distance
1 is 2.5:2. As a consequence of this, distance 4 and 3 will have a
ratio of 2.5:3.


Note: Constant ratio refinement and APID refinement can not be
combined. In the latter case a prescribed distance can be held
constant (not adjusted by the APID function) by supplying a DISTAN
card for this distance and punching a C in column 42.


</pre><hr><pre>
                                                               3-25
LINRES card

FORMAT (A6,1X,F8.1,1X,5(F4.0,2A1,A6,1X,A1,A6),1X,A1,1X)

This card allows to impose linear restrictions on the shifts of the
atom coordinates in the form of hard and/or soft constraints. These
restrictions take the form

        2.0 * #X (ATOM1) - 1.0 * #Z (ATOM3) = 0

as an example.


Cols.     Specified punchinq or function of the field
-----     -------------------------------------------
 1 -  6   LINRES
 8 - 15   Weight or sigma of this restriction for soft
          constraints. If this field is left blank, the re-
          striction will be taken as a hard constraint and
          the variable of the last term of this restriction
          is eliminated. Values preceded by a minus sign are
          interpreted as weights, otherwise they are taken
          as sigmas and the weight for the restriction is
          calculated as follows:

            Weight = 1/(sigma * nr. of terms in restriction)

17 - 20   First coefficient of the restriction. If the
          coefficient is +1.0, the field can be left
          blank.
     21   Multiplication sign * (optional)
     22   X, Y or Z
23 - 28   Atom label


Further terms of the restriction are punched in the same manner in
the columns


29-32, 41-44, 53-56, 65-68      coefficients

   33,    45,    57,    69      multiplication sign (optional)

   34,    46,    58,    70      X, Y or Z

35-40, 47-52, 59-64, 71-76      atom label


</pre><hr><pre>
                                                               3-26
LINRES card  (Cont.)


In this way up to 5 terms can be punched per card. The restriction
can be continued on further cards using the same format (the weight
can be omitted). On the last card of the restriction the two
characters "=0" must be punched in columns 78-79. A restriction may
contain up to 20 terms. Blank fields may be left on cards, i.e. one
can use as many cards as are desired.


Note: A hard constraint on a single coordinate (e.g. #X (ATOM1) = 0)
      must be put in using a NOREF card.





</pre><hr><pre>
                                                               3-27
FILES card

          FORMAT (A6,I3,3X,I3)

The FILES card is used to change at any time the logical number of
the input file and the parameter output file (not the printing
file). In this way, the input or part of it can be read from a mass
storage file and not from the card reader, and the parameter output
can be diverted either to the card. punch or a disk file.

Although the FILES card can be placed anywhere in the data deck it
will mainly be used in connection with the transfer of parameters
from one job to another. In this case, it has to be inserted after
the ATOM cards to read the new parameters from the file (which are
on NATOM cards) and also after the TETCON card (if used) in place
of or before the DISTAN cards.

Please note that when a refinement is divided into several jobs, the
card deck is not changed except for the insertion of the FILES
cards. Only the DISTAN cards are removed if in the previous job the
prescribed distances were altered, either by a constant ratio
refinement or an APID cycle. (For further details see section on the
format of the parameter file.)


Cols.     Specified punching or function of the field
-----     -------------------------------------------
 1 -  5   FILES
 7 -  9   logical number NTIN of the input file
13 - 15   logical number NFILEA of the parameter file
          (output file) or card punch


</pre><hr><pre>
                                                               3-28
FILES card  (Cont.)


The default values set by the program (in subroutine DATIN)
are

        NTIN    = 5  Input file (normally card reader)

        NFILEA  = 8  Parameter output file

        NTOUT   = 6  Output file (printer)


If a field is left blank, the file number is not changed. In the
present version, the file numbers 7, 8, 9 and 10 can be used. If
number 8 is chosen as input file the file will be rewound each time
the FILES 8 cardis encountered. The file number 7 is assigned to the
card punch.





</pre><hr><pre>
                                                               3-29

END card

          FORMAT (A6)

The END card signals the end of a data deck and starts the
computation. After this card another complete job may follow.


Cols.     Specified punching
-----     ------------------
 1 -  3   END





FINISH card

          FORMAT (A5)

After reading this card, the program is immediately stopped. It must
occur at the very end of a data deck.


Cols.     Specified punching
-----     ------------------
 1 -  6   FINISH


</pre><hr><pre>
                                                               3-30





</pre><hr><pre>
                                                               3-31
3.2 Parameter File

When requested in column 50 of the DLS-76 card the refined
parameters (atom coordinates and also cell constants and distances
if their values have been changed in the run) are written on a
separate file which can be used as input of a subsequent run. The
file consists of coded card records and the card format is similar
or identical to the normal input cards. Currently the following card
types will be written:


  Name       Content
(Col. 1-6)

  TITLE      title as supplied on input card
  CYCLE      FORMAT (A6,I4,2I5)
             NC, NA, NS (see DLS-76 card, cols. 23-28)
             All parameter sets are identified by such a
             card. When reading the file the program can
             thus select the requested set.
  CELL       Format like normal input card(1
  NATOM      new atom parameters, format as on ATOM card
             (coordinates only)
  DISTAN     Format like normal input card(1

  FILES  N   Here N is the logical number of the card reader.
             This card appears at the end of a set of parameter
             cards and switches the input back to the normal
             input device.





(1  These cards are only written when the values of the respective
    parameters have been changed.


</pre><hr><pre>
                                                               3-32





</pre><hr><pre>
                                                               3-33
BOUND card  (CDC-version only)

          FORMAT (A6,4X,4E10.4)

With this card limits or bounds can be specified for the weighted
deviations of linear restrictions and/or distances. If the residual
of a particular restriction or distance exceeds these limits the
corresponding weight will be multiplied by the absolute value of the
residual divided by the "modified bound". The "modified bound" has
to be smaller than the specified limit and is calculated according
to the following equation:

        "modified bound" = 3.0 * bound/(3.0+t)

where t is supplied on the card.


Cols.     Specified punching or function of the field
-----     -------------------------------------------
 1 -  5   BOUND
11 - 20   Bound for linear restrictions defined in multiples
          of sigmas (see LINRES card).
          (default: 3.0)
21 - 30   Term t for the calculation of the "modified
          bound" in linear restrictions, a suitable value
          is 1.0. If left blank no bound checks for linear
          restrictions are made.
31 - 40   Bounds for weighted deviations in distances.
          (default: 0.05)
41 - 50   Term t for the calculation of the "modified bound"
          for the distances. Blank: no bound check.


Note: The correction factors will also be written on the parameter
      file on WEIMOD cards and can thus be applied in a subsequent
      run.


</pre><hr><pre>
                                                               3-34





</pre><hr><pre>
                                                               3-35
GENER card (optional)  (CDC-version only)

          FORMAT (A6,4X,3I5)

When this card is encountered the symmetry information for the
specified space group is read from the file and all required atoms
outside the asymmetric unit (i.e. atoms on the SYMEQ-cards) are
generated and their connectivity determined (i.e. the information
contained on the TETCON cards). Thus SYMEQ cards and TETCON cards
are not required in this case. The program assumes the four shortest
T-O and T-T bonds to be the correct connections and therefore the
atom coordinates should already be sufficient accurate.


Cols.     Specified punchinq or function of the field
-----     -------------------------------------------
 1 -  5   GENER
11 - 15   Space group number as in International Tables
          of X-Ray Crystallography, Vol. I. If
          two orientations are listed (e.g. space group
          125, P4/nbm) the first listed is positive (+)
          and the second is negative (-). The symmetry
          cards are read from the master data file of
          program POWD (Smith Plot Program).
16 - 20   File number of the symmetry data file (default 8)
21 - 21   0/1: Do not/print all information used to set
          up the connectivity tables. This may be used as
          a debugging aid in case the automatic setting
          up has failed (e.g. because of inaccurate starting
          coordinates).


Note:  The GENER card should appear after the ATOM cards in
       place of the SYMEQ cards. The TETCON cards must also
       be omitted.However, DISTAN cards may still be added.


</pre><hr><pre>
                                                               4-1
4. EXAMPLES
-----------

Two test examples are provided to illustrate the operation
and output of DLS-76. The first example is a straight-forward
DLS-refinement and can be used to check the basic operations
of the program. The second example is somewhat more elaborate
and makes use of a number of special features of DLS-76. Some
background information and a description of the two examples
is given below.


Example 1: Low-quartz-type structure of AlPO4

AlPO4 has a quartz-type structure which was refined in space
group P3121 by D. SCHWARZENBACH (1966). The following data
are required to set up the basic DLS job:

Unit cell parameters:  hexagonal system
        a = 4.9429 A,      c = 10.9476 A

Atomic positions:  There are 4 atoms in the asymmetric
unit, i.e.

        Al in 3a        x, 0, 1/3
        P  in 3b        x, x, 1/2
        O1 in 6c        x, y, z
        02 in 6c        x, y, z


For each of these atoms an ATOM card has to be punched,
containing the atom label, approximate coordinates and,
in case of Al and P, a specification of those parameters
which are fixed by symmetry. Further atoms supplied on
SYMEQ cards have to be included in order to be able to
specify all independent distances. Besides a new atom label
each of these cards contains the label of the symmetrically


</pre><hr><pre>
                                                               4-2

related atom on the respective ATOM card and the transfor-
mation (including translational components where applicable)
which generates the coordinates of this additional atom.

Interatomic distances: In the present example the inter-
atomic distances are supplied by DISTAN cards(1. For each
independent distance (T-O and O-O distances, T = Al, P) one
DISTAN card is punched. Each such card contains the atom
labels of two atoms, the prescribed value of their distance
and the weight associated with this distance. The values
for the T-O distances used here are those given by
LOUISNATHAN and GIBBS (1972) and the O-O distances are cal-
culated assuming an ideal tetrahedral angle.

The input and output for this example using the Newton-
Raphson procedure is reproduced below. The refinement con-
verges after 6 cycles. The parameters, the shifts and the
resulting interatomic distances are printed for the first
and the last cycle only, as specified on the DLS-76 input
card. For the intermediate cycles only the R-values are
printed which serve as an indication of the progress of the
refinement.





(1  Alternatively, TETCON and BONDIS cards could be used in this
    case.


</pre><hr><pre>
                                                               4-3

Input for Example 1:


TITLE  *** EXAMPLE 1 :  ALPO4  ***  SPACE GROUP P3(1)21
DLS-76   1    10
CELL   HEX          4.9429              10.9476
ATOM   AL      .4                          X,0,1/3
ATOM   P       .6                          X,X,1/2
ATOM   O1      .5      .4      .3
ATOM   O2      .8      .7      .6
SYMEQ  O1     O1*    X-Y,-Y,2/3-Z
SYMEQ  O1     O1**   Y,X,1-Z
SYMEQ  O2     O2*    Y-X+1,1-X,Z-1/3
SYMEQ  O2     O2**   Y,X-1,1-Z
SYMEQ  O2     O2***  Y,X,1-Z
DISTAN AL     O1     1.748     2.
DISTAN AL     O2*    1.748     2.
DISTAN O1     O1*    2.8545    1.
DISTAN O1     O2*    2.8545    1.
DISTAN O1     O2**   2.8545    1.
DISTAN O2*    O2**   2.8545    1.
DISTAN P      O1     1.538     2.
DISTAN P      O2     1.538     2.
DISTAN O1     O1**   2.5115    1.
DISTAN O1     O2     2.5115    1.
DISTAN O1     O2***  2.5115    1.
DISTAN O2     O2***  2.5115    1.
END
FINISH


</pre><hr><pre>
                                                               4-4
                                                               4-5
                                                               4-6

------------------------------------------------------------------------



DLS-76        *** EXAMPLE 1 :  ALPO4  ***  SPACE GROUP P3(1)21                         DATE: 24-MAY-95       PAGE   1




PROGRAM SPECIFICATIONS
----------------------

   REFINEMENT        MATRIX          RANDOM        CONST DIST     CONST  RATIO   PRESCRIBED DO        CELL
      TYPE         INVERSION       COORDINATES     REFINEMENT      REFINEMENT      ADJUSTMENT      REFINEMENT

   NEW RAPHS          FULL             NO          10 CYCLES           NO              NO              NO




PARAMETERS FROM   CONVERGENCE     USE VARIABLE    TRANSL FINAL
(CYC./APID/SET)      TEST         DAMP  FACTOR    COORDINATES

     CARDS           YES               NO              NO




OUTPUT CONTROL
--------------

      LIST            LIST        LIST MATRIX     LIST CORREL    WRITE PARAMETERS
   PARAMETERS       DISTANCES     AND VECTOR      COEFFICIENTS   ON NFILEA ( 8)

   FIRST/LAST      FIRST/LAST          NO              NO              NO






CONTROL FACTORS
---------------

        DAMPING FACTORS           STARTING  NR    CONVERGENCE    LINRES WEIGHTS  WTS FACTOR FOR   CORR MATRIX
COORDINATES   CELL    DISTANCES   RANDOM GENER    TEST FACTOR    MULTIPLIED BY  OUT OF RANGE D'S  TEST FACTOR

   1.000     1.000      1.000            0         0.0001000           1.00000         1.00          0.50




PRELIMINARY STATISTICS
----------------------

  NUMBER OF        NUMBER OF      NUMBER OF       NUMBER OF       NUMBER OF
INDEPEND.ATOMS    DEPEND.ATOMS    DISTANCES       VARIABLES      RESTRICTIONS

       4                5             12              8         0 HARD/ 0 SOFT



DLS-76        *** EXAMPLE 1 :  ALPO4  ***  SPACE GROUP P3(1)21                         DATE: 24-MAY-95       PAGE   2




INITIAL PARAMETERS
------------------

                   R=REFINE      D=DEPENDENT IN A SPECIAL POSITION

                   I=INVARIANT   L=DEPENDENT DUE TO A LINEAR RESTRICTION

CELL PARAMETERS


     A           B           C          ALPHA        BETA       GAMMA       VARIABLES

   4.9429 I    4.9429 D   10.9476 I     90.00 I     90.00 I    120.00 I       0 -  0


ATOM PARAMETERS



ATOM      X         Y         Z         TYPE      N      SPECIAL POSITIONS

AL     0.40000 R 0.00000 I 0.33333 I              1       X,0,1/3
P      0.60000 R 0.60000 D 0.50000 I              2       X,X,1/2
O1     0.50000 R 0.40000 R 0.30000 R              3
O2     0.80000 R 0.70000 R 0.60000 R              6

(N=NO OF THE FIRST VAR. IN THIS LINE)



SYMMETRICALLY DEPENDENT ATOMS                  SYMMETRY OPERATIONS

O1*    0.10000  -0.40000   0.36667             X-Y,-Y,2/3-Z
O1**   0.40000   0.50000   0.70000             Y,X,1-Z
O2*    0.90000   0.20000   0.26667             Y-X+1,1-X,Z-1/3
O2**   0.70000  -0.20000   0.40000             Y,X-1,1-Z
O2***  0.70000   0.80000   0.40000             Y,X,1-Z




INTERATOMIC DISTANCES BEFORE CYCLE   1

ATOM 1 ATOM 2 CALCULATED D PRESCRIBED DO     DO-D    WEIGHT     W*(DO-D)

AL     O1        1.8192        1.7480     -0.0712    2.0000     -0.1423
AL     O2*       2.2748        1.7480     -0.5268    2.0000     -1.0536
O1     O1*       3.5015        2.8545     -0.6470    1.0000     -0.6470
O1     O2*       2.6409        2.8545      0.2136    1.0000      0.2136
O1     O2**      3.7287        2.8545     -0.8742    1.0000     -0.8742
O2*    O2**      2.2500        2.8545      0.6045    1.0000      0.6045
P      O1        2.3509        1.5380     -0.8129    2.0000     -1.6259
P      O2        1.3898        1.5380      0.1482    2.0000      0.2965
O1     O1**      4.4619        2.5115     -1.9504    1.0000     -1.9504



DLS-76        *** EXAMPLE 1 :  ALPO4  ***  SPACE GROUP P3(1)21                         DATE: 24-MAY-95       PAGE   3




O1     O2        3.6035        2.5115     -1.0920    1.0000     -1.0920
O1     O2***     2.0323        2.5115      0.4792    1.0000      0.4792
O2     O2***     2.3510        2.5115      0.1605    1.0000      0.1605





R=SQRT( SUM(W*(DO-D))**2 / SUM(W*DO)**2 )=   0.32529685     BEFORE CYCLE   1
SIGMA=SQRT( SUM(W*(DO-D))**2 / (M-NV) )  =   1.63613963





PARAMETERS AFTER CYCLE   1

    PARAMETER      OLD       CHANGE      NEW                     PARAMETER      OLD       CHANGE      NEW

ATOM AL                                                      ATOM P
       X         0.40000   -0.11670    0.28330                      X         0.60000   -0.12685    0.47315
       Y         0.00000    0.00000    0.00000                      Y         0.60000   -0.12685    0.47315
       Z         0.33333    0.00000    0.33333                      Z         0.50000    0.00000    0.50000
ATOM O1                                                      ATOM O2
       X         0.50000   -0.08358    0.41642                      X         0.80000    0.14474    0.94475
       Y         0.40000   -0.01377    0.38623                      Y         0.70000   -0.17291    0.52709
       Z         0.30000    0.06864    0.36864                      Z         0.60000   -0.06723    0.53277


SYMMETRICALLY DEPENDENT ATOMS

ATOM      X        Y        Z

O1*    0.03020 -0.38623  0.29803
O1**   0.38623  0.41642  0.63136
O2*    0.58235  0.05525  0.19943
O2**   0.52709 -0.05525  0.46723
O2***  0.52709  0.94475  0.46723


R=SQRT( SUM(W*(DO-D))**2 / SUM(W*DO)**2 )=   0.20469035     BEFORE CYCLE   2
SIGMA=SQRT( SUM(W*(DO-D))**2 / (M-NV) )  =   1.02952731


R=SQRT( SUM(W*(DO-D))**2 / SUM(W*DO)**2 )=   0.06937429     BEFORE CYCLE   3
SIGMA=SQRT( SUM(W*(DO-D))**2 / (M-NV) )  =   0.34893057


R=SQRT( SUM(W*(DO-D))**2 / SUM(W*DO)**2 )=   0.01674912     BEFORE CYCLE   4
SIGMA=SQRT( SUM(W*(DO-D))**2 / (M-NV) )  =   0.08424272


R=SQRT( SUM(W*(DO-D))**2 / SUM(W*DO)**2 )=   0.00697363     BEFORE CYCLE   5
SIGMA=SQRT( SUM(W*(DO-D))**2 / (M-NV) )  =   0.03507515


R=SQRT( SUM(W*(DO-D))**2 / SUM(W*DO)**2 )=   0.00664027     BEFORE CYCLE   6
SIGMA=SQRT( SUM(W*(DO-D))**2 / (M-NV) )  =   0.03339842

CONVERGENCE TEST POSITIVE AFTER CYCLE   6



DLS-76        *** EXAMPLE 1 :  ALPO4  ***  SPACE GROUP P3(1)21                         DATE: 24-MAY-95       PAGE   4




APPROXIMATE EIGENVALUES OF MATRIX (LAST CYCLE):

 0.1951E+04 0.1798E+04 0.2355E+03 0.2006E+03 0.8508E+02 0.7552E+02 0.6704E+02 0.4515E+02






PARAMETERS AFTER CYCLE   6

    PARAMETER      OLD       CHANGE      NEW                     PARAMETER      OLD       CHANGE      NEW

ATOM AL                                                      ATOM P
       X         0.46171    0.00004    0.46175                      X         0.53424   -0.00003    0.53421
       Y         0.00000    0.00000    0.00000                      Y         0.53424   -0.00003    0.53421
       Z         0.33333    0.00000    0.33333                      Z         0.50000    0.00000    0.50000
ATOM O1                                                      ATOM O2
       X         0.40947    0.00001    0.40948                      X         0.84793   -0.00005    0.84788
       Y         0.29672   -0.00006    0.29666                      Y         0.58520    0.00002    0.58521
       Z         0.39445    0.00002    0.39448                      Z         0.54941    0.00002    0.54943


SYMMETRICALLY DEPENDENT ATOMS

ATOM      X        Y        Z

O1*    0.11282 -0.29666  0.27219
O1**   0.29666  0.40948  0.60552
O2*    0.73734  0.15212  0.21610
O2**   0.58521 -0.15212  0.45057
O2***  0.58521  0.84788  0.45057



INTERATOMIC DISTANCES BEFORE CYCLE   7

ATOM 1 ATOM 2 CALCULATED D PRESCRIBED DO     DO-D    WEIGHT     W*(DO-D)

AL     O1        1.7447        1.7480      0.0033    2.0000      0.0066
AL     O2*       1.7447        1.7480      0.0033    2.0000      0.0067
O1     O1*       2.8711        2.8545     -0.0166    1.0000     -0.0166
O1     O2*       2.8474        2.8545      0.0071    1.0000      0.0071
O1     O2**      2.8248        2.8545      0.0297    1.0000      0.0297
O2*    O2**      2.8784        2.8545     -0.0239    1.0000     -0.0239
P      O1        1.5393        1.5380     -0.0013    2.0000     -0.0026
P      O2        1.5393        1.5380     -0.0013    2.0000     -0.0026
O1     O1**      2.5042        2.5115      0.0073    1.0000      0.0073
O1     O2        2.5528        2.5115     -0.0413    1.0000     -0.0413
O1     O2***     2.4876        2.5115      0.0239    1.0000      0.0239
O2     O2***     2.4957        2.5115      0.0158    1.0000      0.0158





R=SQRT( SUM(W*(DO-D))**2 / SUM(W*DO)**2 )=   0.00663989     BEFORE CYCLE   7
SIGMA=SQRT( SUM(W*(DO-D))**2 / (M-NV) )  =   0.03339653



DLS-76        *** EXAMPLE 1 :  ALPO4  ***  SPACE GROUP P3(1)21                         DATE: 24-MAY-95       PAGE   5




TOTAL PARAMETER SHIFTS AFTER LAST CYCLE

    PARAMETER    INITIAL     CHANGE      FINAL      SHIFT        PARAMETER    INITIAL     CHANGE      FINAL      SHIFT

ATOM AL                                                      ATOM P
       X         0.40000    0.06175    0.46175    0.30522           X         0.60000   -0.06579    0.53421   -0.32520
       Y         0.00000    0.00000    0.00000    0.00000           Y         0.60000   -0.06579    0.53421   -0.32520
       Z         0.33333    0.00000    0.33333    0.00000           Z         0.50000    0.00000    0.50000    0.00000
       MAGNITUDE                                  0.30522           MAGNITUDE                                  0.32520
ATOM O1                                                      ATOM O2
       X         0.50000   -0.09052    0.40948   -0.44743           X         0.80000    0.04788    0.84788    0.23664
       Y         0.40000   -0.10334    0.29666   -0.51078           Y         0.70000   -0.11479    0.58521   -0.56739
       Z         0.30000    0.09448    0.39448    1.03429           Z         0.60000   -0.05057    0.54943   -0.55358
       MAGNITUDE                                  1.14119           MAGNITUDE                                  0.90479
------------------------------------------------------------------------

*** FINISH ***


</pre><hr><pre>
                                                               4-7
Example 2:  Desymmetrization of the crystal structure of
            analcime


Analcime is a framework silicate and is normally described
as cubic with space group Ia3d and a = 13.73 R . It has a
remarkably constant unit cell composition of
Na16Al16Si32096 . 16 H2O, which, if fully ordered, is in-
compatible with cubic symmetry. MEIER (1973) therefore
proposed on the basis of DLS calculations that the symmetry
should at least be reduced to I41/acd which would allow for
Si, Al ordering assuming a likely distribution scheme.

A recent neutron-diffraction study (FERRARIS et al., 1972)
based on space group Ia3d led to the following atomic co-
ordinates of the framework atoms (estimated standard de-
viation in parentheses):


T(Si,Al) in 48g .16208(15) .08792(15) .125        (x,1/4-x,1/8)
O        in 96h .10428(14) .13440(16) .21932(12)  (x,y,z)


On reducing the symmetry to I41/acd these two positions
would split up into the following 5 independent positions(1
(origin in -1):


T1(Al)  in 16f .16208   .08792  .125    (x,1/4-x,1/8)
T2(Si)  in 32g .08792   .12500  .33792  (x,y,z)
O1      in 32g .10428   .13440  .21932
O2      in 32g .14572   .03068  .38440
O3      in 32g .13440   .21932  .39572


These parameters are punched on ATOM cards and could be used
as starting parameters. However, they still possess cubic


(1  Compared to the setting in the Int. Tables (Vol. I, page 142)
    the origin has been shifted to 0,0,1/2.


</pre><hr><pre>
                                                               4-8

symmetry and are unlikely to refine in the tetragonal space
group. Instead, somewhat desymmetrized or random coordinates
are needed for starting the refinement. The values on the
atom cards are then used as reference coordinates only in
the calculation of the linear restrictions and in the cal-
culation of the total parameter shifts. To enable actual
checking in this test example "pseudo-random" coordinates
supplied by NATOM cards are used here. Such cards are usually
only read from the parameter file and overwrite the starting
coordinates but not the reference coordinates.

As pointed out in Section 1 the symmetrized DLS coordinates
should still agree (say within 3#) with the experimentally
determined coordinates of the high-symmetry reference
structure. Therefore, restrictions have to be placed on the
total coordinate shifts. These restrictions are applied as
weighted constraints. In this example the 3-fold axes are
removed and the constraints are accordingly:

        #x(T1) -  #z(T2) -  #x(T2) = 0
        #x(O1) -  #x(O2) -  #z(O3) = 0
        #y(O1) +  #z(O2) +  #x(O3) = 0
        #z(O1) -  #y(O2) +  #y(O3) = 0

These equations are punched on LINRES cards. The weights
used here are the reciprocal values of the estimated
standard deviations of the respective coordinates as ob-
tained by FERRARIS et al. (1972). These weights are all
multiplied by a factor of .012 (punched on the FACTOR card)
to scale them to the weights of the distance error equations.

The distance error equations for this example are generated
from two TETCON cards (one for each tetrahedron). For the
prescribed interatomic distances a function is supplied
(on a BONDIS card) for each bond type giving the relation-
ship between T-O bond distance and T-O-T angle which is
taken into account in an APID cycle after a maximum of 15
cycles of DLS refinement using standard distance values.


</pre><hr><pre>
                                                               4-9

The input and complete output is reproduced below. The
linear restrictions, bond distance functions and (as a check)
the bonding scheme for each tetrahedron as stated on the
TETCON card are also printed. Despite the near-random
starting coordinates used in this example, the Newton-Gauss
refinement converges in 12 cycles, i.e. the shifts in the
coordinates become all less than 0.0001 after 12 cycles.
The parameter shifts, the interatomic distances, the dif-
ference vectors relative to the initial (reference) coordi-
nates and the residuals of the linear restrictions are again
only printed for the first and final cycle. For the inter-
mediate cycles only the R-values are printed and in
addition the sum RHO over all squared residuals resulting
from the distances and the linear restrictions. Once the
convergence test becomes positive (after 12 cycles), the
prescribed distances are adjusted according to the function
supplied and the T-O-T angles in the model. A list of all
the actual distances in the refined model, the original
distances as well as the new prescribed distances are
printed, and another refinement with the new set of pres-
cribed distances is started. Convergence is reached after
3 cycles and all final parameters and values are then
printed. The differences in the coordinates of the refined
DLS model and the reference structure are given in the last
table of the output.


</pre><hr><pre>
                                                               4-10

Input for Example 2:


TITLE  *** EXAMPLE 2 :  ANALCIME  ***  I4(1)/ACD   (WITH LINEAR RESTRICTIONS)
DLS-76        15   1
FACTOR                                  .012
CELL   TET          13.73               13.73
ATOM   T1    .16208                    AL  X,1/4-X,1/8
ATOM   T2    .08792  .125    .33792    SI
ATOM   O1    .10428  .1344   .21932    O
ATOM   O2    .14572  .03068  .3844     O
ATOM   O3    .1344   .21932  .39572    O
NATOM  T1      .11     .14     .125
NATOM  T2      .21     .22     .23
NATOM  O1      .31     .32     .33
NATOM  O2      .41     .42     .43
NATOM  O3      .51     .52     .53
SYMEQ  T1     T1*    X,-Y,1/2-Z
SYMEQ  T2     T2*    1/4-Y,1/4+X,3/4-Z
SYMEQ  T2     T2**   Y-1/4,1/4-X,3/4-Z
SYMEQ  T2     T2***  1/4+Y,1/4-X,Z-1/4
SYMEQ  O1     O1*    1/4-Y,1/4-X,1/4-Z
SYMEQ  O2     O2*    1/4+Y,1/4-X,Z-1/4
SYMEQ  O2     O2**   X,-Y,1/2-Z
SYMEQ  O3     O3*    Y-1/4,1/4-X,3/4-Z
BONDIS SI  O   SI   1.620     -.0004    0.        145.      2.   1.   .1
BONDIS SI  O   AL   1.593     -.0004                        2.   1.   .1
BONDIS AL  O   SI   1.740     -.0004                        2.   1.   .1
TETCON       T1     O1     O2*    O1*    O2**   T2     T2***
TETCON       T2     O1     O2     O3     O3*    T1     T1*    T2*    T2**
LINRES 2223.    1.  *XT1    -1. *ZT2    -1. *XT2                             =0
LINRES 2380.    1.  *XO1    -1. *XO2    -1. *ZO3                             =0
LINRES 2083.    1.  *YO1     1. *ZO2    1.  *XO3                             =0
LINRES 2776.    1.  *ZO1    -1. *YO2    1.  *YO3                             =0
END
FINISH


</pre><hr><pre>
                                                               4-11
                                                               4-12
                                                               4-13
                                                               4-14
                                                               4-15
                                                               4-16

------------------------------------------------------------------------



DLS-76        *** EXAMPLE 2 :  ANALCIME  ***  I4(1)/ACD   (WITH LINEAR RESTRICTIONS)   DATE: 24-MAY-95       PAGE   1




PROGRAM SPECIFICATIONS
----------------------

   REFINEMENT        MATRIX          RANDOM        CONST DIST     CONST  RATIO   PRESCRIBED DO        CELL
      TYPE         INVERSION       COORDINATES     REFINEMENT      REFINEMENT      ADJUSTMENT      REFINEMENT

   NEW GAUSS          FULL             NO          15 CYCLES           NO           1 CYCLES           NO




PARAMETERS FROM   CONVERGENCE     USE VARIABLE    TRANSL FINAL
(CYC./APID/SET)      TEST         DAMP  FACTOR    COORDINATES

     CARDS           YES               NO              NO




OUTPUT CONTROL
--------------

      LIST            LIST        LIST MATRIX     LIST CORREL    WRITE PARAMETERS
   PARAMETERS       DISTANCES     AND VECTOR      COEFFICIENTS   ON NFILEA ( 8)

   FIRST/LAST      FIRST/LAST          NO              NO              NO






CONTROL FACTORS
---------------

        DAMPING FACTORS           STARTING  NR    CONVERGENCE    LINRES WEIGHTS  WTS FACTOR FOR   CORR MATRIX
COORDINATES   CELL    DISTANCES   RANDOM GENER    TEST FACTOR    MULTIPLIED BY  OUT OF RANGE D'S  TEST FACTOR

   1.000     1.000      1.000            0         0.0001000           0.01200         1.00          0.50




PRELIMINARY STATISTICS
----------------------

  NUMBER OF        NUMBER OF      NUMBER OF       NUMBER OF       NUMBER OF
INDEPEND.ATOMS    DEPEND.ATOMS    DISTANCES       VARIABLES      RESTRICTIONS

       5                8             19             13         0 HARD/ 4 SOFT



DLS-76        *** EXAMPLE 2 :  ANALCIME  ***  I4(1)/ACD   (WITH LINEAR RESTRICTIONS)   DATE: 24-MAY-95       PAGE   2




INITIAL PARAMETERS
------------------

                   R=REFINE      D=DEPENDENT IN A SPECIAL POSITION

                   I=INVARIANT   L=DEPENDENT DUE TO A LINEAR RESTRICTION

CELL PARAMETERS


     A           B           C          ALPHA        BETA       GAMMA       VARIABLES

  13.7300 I   13.7300 D   13.7300 I     90.00 I     90.00 I     90.00 I       0 -  0


ATOM PARAMETERS



ATOM      X         Y         Z         TYPE      N      SPECIAL POSITIONS

T1     0.11000 R 0.14000 D 0.12500 I     AL       1       X,1/4-X,1/8
T2     0.21000 R 0.22000 R 0.23000 R     SI       2
O1     0.31000 R 0.32000 R 0.33000 R     O        5
O2     0.41000 R 0.42000 R 0.43000 R     O        8
O3     0.51000 R 0.52000 R 0.53000 R     O       11

(N=NO OF THE FIRST VAR. IN THIS LINE)



SYMMETRICALLY DEPENDENT ATOMS                  SYMMETRY OPERATIONS

T1*    0.11000  -0.14000   0.37500             X,-Y,1/2-Z
T2*    0.03000   0.46000   0.52000             1/4-Y,1/4+X,3/4-Z
T2**  -0.03000   0.04000   0.52000             Y-1/4,1/4-X,3/4-Z
T2***  0.47000   0.04000  -0.02000             1/4+Y,1/4-X,Z-1/4
O1*   -0.07000  -0.06000  -0.08000             1/4-Y,1/4-X,1/4-Z
O2*    0.67000  -0.16000   0.18000             1/4+Y,1/4-X,Z-1/4
O2**   0.41000  -0.42000   0.07000             X,-Y,1/2-Z
O3*    0.27000  -0.26000   0.22000             Y-1/4,1/4-X,3/4-Z


LINEAR RESTRICTIONS

NR     WEIGHT

 1   0.222E+04    0 =   1.0*DX (T1    ) - 1.0*DZ (T2    ) - 1.0*DX (T2    )
 2   0.238E+04    0 =   1.0*DX (O1    ) - 1.0*DX (O2    ) - 1.0*DZ (O3    )
 3   0.208E+04    0 =   1.0*DY (O1    ) + 1.0*DZ (O2    ) + 1.0*DX (O3    )
 4   0.278E+04    0 =   1.0*DZ (O1    ) - 1.0*DY (O2    ) + 1.0*DY (O3    )



DLS-76        *** EXAMPLE 2 :  ANALCIME  ***  I4(1)/ACD   (WITH LINEAR RESTRICTIONS)   DATE: 24-MAY-95       PAGE   3





BOND DISTANCE FUNCTIONS

  BOND - TYPE                                     FUNCTION                                       W(T-O)    W(O-O)    W(T-T)

SI  - O  ... SI   DO = 1.62000 + -0.4000E-03 * (TOT - 145.0) +  0.0000E+00 * (TOT - 145.0)**2    2.0000    1.0000    0.1000
SI  - O  ... AL   DO = 1.59300 + -0.4000E-03 * (TOT - 145.0) +  0.0000E+00 * (TOT - 145.0)**2    2.0000    1.0000    0.1000
AL  - O  ... SI   DO = 1.74000 + -0.4000E-03 * (TOT - 145.0) +  0.0000E+00 * (TOT - 145.0)**2    2.0000    1.0000    0.1000

DO( SI - SI ) IS CALCULATED USING AN ANGLE OF 145.0 DEGREES
DO( SI - AL ) IS CALCULATED USING AN ANGLE OF 145.0 DEGREES
DO( AL - SI ) IS CALCULATED USING AN ANGLE OF 145.0 DEGREES


CONNECTIVITY OF TETRAHEADRAL ATOMS


                T2***                                      T1*

                  I                                          I

                O2*                                        O2

                  I                                          I

T2    - O1    - T1    - O1*   -            T1    - O1    - T2    - O3    - T2*

                  I                                          I

                O2**                                       O3*

                  I                                          I

                                                           T2**




INTERATOMIC DISTANCES BEFORE CYCLE   1

ATOM 1 ATOM 2 CALCULATED D PRESCRIBED DO     DO-D    WEIGHT     W*(DO-D)

T1     O1        4.6444        1.7400     -2.9044    2.0000     -5.8088
T1     O2*       8.7552        1.7400     -7.0152    2.0000    -14.0305
O1     O2*       8.4915        2.8414     -5.6501    1.0000     -5.6501
O1     O1*       9.2807        2.8414     -6.4393    1.0000     -6.4393
O1     O2**     10.8563        2.8414     -8.0148    1.0000     -8.0148
O2*    O2**      5.2695        2.8414     -2.4281    1.0000     -2.4281
T2     O1        2.3781        1.5930     -0.7851    2.0000     -1.5702
T2     O2        4.7562        1.5930     -3.1632    2.0000     -6.3264
T2     O3        7.1343        1.6200     -5.5143    2.0000    -11.0286
T2     O3*       6.6431        1.6200     -5.0231    2.0000    -10.0462
O1     O2        2.3781        2.6014      0.2233    1.0000      0.2233
O1     O3        4.7562        2.6234     -2.1328    1.0000     -2.1328
O1     O3*       8.1239        2.6234     -5.5005    1.0000     -5.5005
O2     O3        2.3781        2.6234      0.2453    1.0000      0.2453



DLS-76        *** EXAMPLE 2 :  ANALCIME  ***  I4(1)/ACD   (WITH LINEAR RESTRICTIONS)   DATE: 24-MAY-95       PAGE   4




O2     O3*       9.9587        2.6234     -7.3353    1.0000     -7.3353
O3     O3*      11.9861        2.6454     -9.3406    1.0000     -9.3406
T1     T2        2.2738        3.1790      0.9053    0.1000      0.0905
T1     T2***     5.5027        3.1790     -2.3237    0.1000     -0.2324
T2     T2*       5.7289        3.0900     -2.6388    0.1000     -0.2639





R=SQRT( SUM(W*(DO-D))**2 / SUM(W*DO)**2 )=   2.39539957     BEFORE CYCLE   1
SIGMA=SQRT( SUM(W*(DO-D))**2 / (M-NV) )  =  11.65664482
RHO=SUM(W*(DO-D))**2 + SUM(W*COND)**2    = 815.26428223





PARAMETERS AFTER CYCLE   1

    PARAMETER      OLD       CHANGE      NEW                     PARAMETER      OLD       CHANGE      NEW

ATOM T1                                                      ATOM T2
       X         0.11000   -0.07915    0.03085                      X         0.21000   -0.18001    0.02999
       Y         0.14000    0.07915    0.21915                      Y         0.22000   -0.13128    0.08872
       Z         0.12500    0.00000    0.12500                      Z         0.23000    0.09707    0.32707
ATOM O1                                                      ATOM O2
       X         0.31000   -0.35343   -0.04343                      X         0.41000   -0.30886    0.10114
       Y         0.32000   -0.11035    0.20965                      Y         0.42000   -0.56107   -0.14107
       Z         0.33000    0.05129    0.38129                      Z         0.43000    0.27581    0.70581
ATOM O3
       X         0.51000   -0.18869    0.32131
       Y         0.52000   -0.60853   -0.08853
       Z         0.53000   -0.04337    0.48663


SYMMETRICALLY DEPENDENT ATOMS

ATOM      X        Y        Z

T1*    0.03085 -0.21915  0.37500
T2*    0.16128  0.27999  0.42293
T2**  -0.16128  0.22001  0.42293
T2***  0.33872  0.22001  0.07707
O1*    0.04035  0.29343 -0.13129
O2*    0.10893  0.14886  0.45581
O2**   0.10114  0.14107 -0.20581
O3*   -0.33853 -0.07131  0.26337



DLS-76        *** EXAMPLE 2 :  ANALCIME  ***  I4(1)/ACD   (WITH LINEAR RESTRICTIONS)   DATE: 24-MAY-95       PAGE   5





DIFFERENCE VECTORS TO INITIAL COORDINATES

ATOM           DX         DY         DZ

T1         -0.13123    0.13123    0.00000
T2         -0.05793   -0.03628   -0.01085
O1         -0.14771    0.07525    0.16197
O2         -0.04458   -0.17175    0.32141
O3          0.18691   -0.30785    0.09091


LINEAR RESTRICTIONS AFTER CYCLE   1

NO OF CONDITION         C            WEIGHT*C  WEIGHT*C/NO OF TERMS

       1            -0.06246      -138.84245       -46.28082
       2            -0.19404      -461.81577      -153.93858
       3             0.58358      1215.59656       405.19885
       4             0.02586        71.79914        23.93305


R=SQRT( SUM(W*(DO-D))**2 / SUM(W*DO)**2 )=   1.81678200     BEFORE CYCLE   2
SIGMA=SQRT( SUM(W*(DO-D))**2 / (M-NV) )  =   8.84093952
RHO=SUM(W*(DO-D))**2 + SUM(W*COND)**2    = 715.98822021


R=SQRT( SUM(W*(DO-D))**2 / SUM(W*DO)**2 )=   0.84998506     BEFORE CYCLE   3
SIGMA=SQRT( SUM(W*(DO-D))**2 / (M-NV) )  =   4.13625145
RHO=SUM(W*(DO-D))**2 + SUM(W*COND)**2    = 105.00346375


R=SQRT( SUM(W*(DO-D))**2 / SUM(W*DO)**2 )=   0.92296815     BEFORE CYCLE   4
SIGMA=SQRT( SUM(W*(DO-D))**2 / (M-NV) )  =   4.49140596
RHO=SUM(W*(DO-D))**2 + SUM(W*COND)**2    = 121.04497528


R=SQRT( SUM(W*(DO-D))**2 / SUM(W*DO)**2 )=   0.44245443     BEFORE CYCLE   5
SIGMA=SQRT( SUM(W*(DO-D))**2 / (M-NV) )  =   2.15309978
RHO=SUM(W*(DO-D))**2 + SUM(W*COND)**2    =  28.06721878


R=SQRT( SUM(W*(DO-D))**2 / SUM(W*DO)**2 )=   0.13950098     BEFORE CYCLE   6
SIGMA=SQRT( SUM(W*(DO-D))**2 / (M-NV) )  =   0.67884851
RHO=SUM(W*(DO-D))**2 + SUM(W*COND)**2    =   2.80475926


R=SQRT( SUM(W*(DO-D))**2 / SUM(W*DO)**2 )=   0.04515689     BEFORE CYCLE   7
SIGMA=SQRT( SUM(W*(DO-D))**2 / (M-NV) )  =   0.21974532
RHO=SUM(W*(DO-D))**2 + SUM(W*COND)**2    =   0.28997770


R=SQRT( SUM(W*(DO-D))**2 / SUM(W*DO)**2 )=   0.01493201     BEFORE CYCLE   8
SIGMA=SQRT( SUM(W*(DO-D))**2 / (M-NV) )  =   0.07266308
RHO=SUM(W*(DO-D))**2 + SUM(W*COND)**2    =   0.03533342



DLS-76        *** EXAMPLE 2 :  ANALCIME  ***  I4(1)/ACD   (WITH LINEAR RESTRICTIONS)   DATE: 24-MAY-95       PAGE   6






R=SQRT( SUM(W*(DO-D))**2 / SUM(W*DO)**2 )=   0.01297724     BEFORE CYCLE   9
SIGMA=SQRT( SUM(W*(DO-D))**2 / (M-NV) )  =   0.06315065
RHO=SUM(W*(DO-D))**2 + SUM(W*COND)**2    =   0.02759915


R=SQRT( SUM(W*(DO-D))**2 / SUM(W*DO)**2 )=   0.01291212     BEFORE CYCLE  10
SIGMA=SQRT( SUM(W*(DO-D))**2 / (M-NV) )  =   0.06283379
RHO=SUM(W*(DO-D))**2 + SUM(W*COND)**2    =   0.02718676


R=SQRT( SUM(W*(DO-D))**2 / SUM(W*DO)**2 )=   0.01292431     BEFORE CYCLE  11
SIGMA=SQRT( SUM(W*(DO-D))**2 / (M-NV) )  =   0.06289312
RHO=SUM(W*(DO-D))**2 + SUM(W*COND)**2    =   0.02716171


R=SQRT( SUM(W*(DO-D))**2 / SUM(W*DO)**2 )=   0.01292994     BEFORE CYCLE  12
SIGMA=SQRT( SUM(W*(DO-D))**2 / (M-NV) )  =   0.06292051
RHO=SUM(W*(DO-D))**2 + SUM(W*COND)**2    =   0.02715991

CONVERGENCE TEST POSITIVE AFTER CYCLE  12

APPROXIMATE EIGENVALUES OF MATRIX (LAST CYCLE):

 0.6960E+04 0.6195E+04 0.4177E+04 0.3183E+04 0.2711E+04 0.2441E+04 0.2144E+04 0.1359E+04 0.1004E+04 0.9461E+03
 0.4662E+03 0.2203E+03 0.1314E+03






PARAMETERS AFTER CYCLE  12

    PARAMETER      OLD       CHANGE      NEW                     PARAMETER      OLD       CHANGE      NEW

ATOM T1                                                      ATOM T2
       X         0.15809    0.00001    0.15809                      X         0.08416    0.00000    0.08416
       Y         0.09191   -0.00001    0.09191                      Y         0.12989   -0.00001    0.12988
       Z         0.12500    0.00000    0.12500                      Z         0.33776    0.00001    0.33777
ATOM O1                                                      ATOM O2
       X         0.10676   -0.00002    0.10674                      X         0.13832    0.00000    0.13832
       Y         0.15000   -0.00004    0.14997                      Y         0.03356    0.00000    0.03356
       Z         0.22574    0.00000    0.22574                      Z         0.37331    0.00003    0.37334
ATOM O3
       X         0.12875    0.00001    0.12876
       Y         0.21675    0.00000    0.21675
       Z         0.40422   -0.00002    0.40420



DLS-76        *** EXAMPLE 2 :  ANALCIME  ***  I4(1)/ACD   (WITH LINEAR RESTRICTIONS)   DATE: 24-MAY-95       PAGE   7






SYMMETRICALLY DEPENDENT ATOMS

ATOM      X        Y        Z

T1*    0.15809 -0.09191  0.37500
T2*    0.12012  0.33416  0.41223
T2**  -0.12012  0.16584  0.41223
T2***  0.37988  0.16584  0.08777
O1*    0.10003  0.14326  0.02426
O2*    0.28356  0.11168  0.12334
O2**   0.13832 -0.03356  0.12666
O3*   -0.03325  0.12124  0.34580

DIFFERENCE VECTORS TO INITIAL COORDINATES

ATOM           DX         DY         DZ

T1         -0.00399    0.00399    0.00000
T2         -0.00376    0.00488   -0.00015
O1          0.00246    0.01557    0.00642
O2         -0.00740    0.00288   -0.01106
O3         -0.00564   -0.00257    0.00848


LINEAR RESTRICTIONS AFTER CYCLE  12

NO OF CONDITION         C            WEIGHT*C  WEIGHT*C/NO OF TERMS

       1            -0.00008        -0.17073        -0.05691
       2             0.00138         3.27439         1.09146
       3            -0.00114        -2.36720        -0.78907
       4             0.00097         2.69342         0.89781



INTERATOMIC DISTANCES BEFORE CYCLE  13

ATOM 1 ATOM 2 CALCULATED D PRESCRIBED DO     DO-D    WEIGHT     W*(DO-D)

T1     O1        1.7452        1.7400     -0.0052    2.0000     -0.0105
T1     O2*       1.7440        1.7400     -0.0040    2.0000     -0.0080
O1     O2*       2.8543        2.8414     -0.0129    1.0000     -0.0129
O1     O1*       2.7694        2.8414      0.0721    1.0000      0.0721
O1     O2**      2.8962        2.8414     -0.0548    1.0000     -0.0548
O2*    O2**      2.8204        2.8414      0.0210    1.0000      0.0210
T2     O1        1.5932        1.5930     -0.0002    2.0000     -0.0003
T2     O2        1.5939        1.5930     -0.0009    2.0000     -0.0019
T2     O3        1.6215        1.6200     -0.0015    2.0000     -0.0029
T2     O3*       1.6202        1.6200     -0.0002    2.0000     -0.0003
O1     O2        2.6172        2.6014     -0.0158    1.0000     -0.0158
O1     O3        2.6336        2.6234     -0.0101    1.0000     -0.0101
O1     O3*       2.5626        2.6234      0.0608    1.0000      0.0608
O2     O3        2.5540        2.6234      0.0694    1.0000      0.0694



DLS-76        *** EXAMPLE 2 :  ANALCIME  ***  I4(1)/ACD   (WITH LINEAR RESTRICTIONS)   DATE: 24-MAY-95       PAGE   8




O2     O3*       2.6724        2.6234     -0.0490    1.0000     -0.0490
O3     O3*       2.7037        2.6454     -0.0582    1.0000     -0.0582
T1     T2        3.1363        3.1790      0.0427    0.1000      0.0043
T1     T2***     3.2503        3.1790     -0.0713    0.1000     -0.0071
T2     T2*       3.0258        3.0900      0.0642    0.1000      0.0064





R=SQRT( SUM(W*(DO-D))**2 / SUM(W*DO)**2 )=   0.01293159     BEFORE CYCLE  13
SIGMA=SQRT( SUM(W*(DO-D))**2 / (M-NV) )  =   0.06292854
RHO=SUM(W*(DO-D))**2 + SUM(W*COND)**2    =   0.02715969



DLS-76        *** EXAMPLE 2 :  ANALCIME  ***  I4(1)/ACD   (WITH LINEAR RESTRICTIONS)   DATE: 24-MAY-95       PAGE   9






INTERATOMIC DISTANCES AND BOND ANGLES AFTER APID CYCLE   1

ATOM 1    ATOM 2    BOND  TYPE    OBSERVED D    OLD DO   CHANGE    NEW DO  DO-DO(START)           BOND             ANGLE


T1        O1        AL  O   SI      1.7452      1.7400   0.0020    1.7420     0.0020      T1    - O1    - T2       139.9
T1        O2*       AL  O   SI      1.7440      1.7400  -0.0035    1.7365    -0.0035      T1    - O2*   - T2***    153.7

O1        O2*                       2.8543      2.8414  -0.0012    2.8403    -0.0012      O1    - T1    - O2*      109.8
O1        O1*                       2.7694      2.8414   0.0033    2.8448     0.0033      O1    - T1    - O1*      105.0
O1        O2**                      2.8962      2.8414  -0.0012    2.8403    -0.0012      O1    - T1    - O2**     112.2
O2*       O1*                       2.8962      2.8414  -0.0012    2.8403    -0.0012      O2*   - T1    - O1*      112.2
O2*       O2**                      2.8204      2.8414  -0.0057    2.8358    -0.0057      O2*   - T1    - O2**     107.9
O1*       O2**                      2.8543      2.8414  -0.0012    2.8403    -0.0012      O1*   - T1    - O2**     109.8

T1        T2                        3.1363      3.1790   0.0039    3.1830     0.0039
T1        T2***                     3.2503      3.1790  -0.0066    3.1724    -0.0066


T2        O1        SI  O   AL      1.5932      1.5930   0.0020    1.5950     0.0020      T2    - O1    - T1       139.9
T2        O2        SI  O   AL      1.5939      1.5930  -0.0035    1.5895    -0.0035      T2    - O2    - T1*      153.7
T2        O3        SI  O   SI      1.6215      1.6200   0.0028    1.6228     0.0028      T2    - O3    - T2*      137.9
T2        O3*       SI  O   SI      1.6202      1.6200   0.0028    1.6228     0.0028      T2    - O3*   - T2**     137.9

O1        O2                        2.6172      2.6014  -0.0012    2.6002    -0.0012      O1    - T2    - O2       110.4
O1        O3                        2.6336      2.6234   0.0040    2.6274     0.0040      O1    - T2    - O3       110.0
O1        O3*                       2.5626      2.6234   0.0040    2.6274     0.0040      O1    - T2    - O3*      105.8
O2        O3                        2.5540      2.6234  -0.0005    2.6230    -0.0005      O2    - T2    - O3       105.2
O2        O3*                       2.6724      2.6234  -0.0005    2.6229    -0.0005      O2    - T2    - O3*      112.5
O3        O3*                       2.7037      2.6454   0.0046    2.6501     0.0046      O3    - T2    - O3*      113.0

T2        T1                        3.1363      3.1790   0.0039    3.1830     0.0039
T2        T1*                       3.2503      3.1790  -0.0066    3.1724    -0.0066
T2        T2*                       3.0258      3.0900   0.0054    3.0954     0.0054
T2        T2**                      3.0258      3.0900   0.0054    3.0954     0.0054







INTERATOMIC DISTANCES BEFORE CYCLE   1 OF APID CYCLE  1

ATOM 1 ATOM 2 CALCULATED D PRESCRIBED DO     DO-D    WEIGHT     W*(DO-D)

T1     O1        1.7452        1.7420     -0.0032    2.0000     -0.0064
T1     O2*       1.7440        1.7365     -0.0075    2.0000     -0.0150
O1     O2*       2.8543        2.8403     -0.0141    1.0000     -0.0141
O1     O1*       2.7694        2.8448      0.0754    1.0000      0.0754
O1     O2**      2.8962        2.8403     -0.0560    1.0000     -0.0560
O2*    O2**      2.8204        2.8358      0.0154    1.0000      0.0154
T2     O1        1.5932        1.5950      0.0019    2.0000      0.0038
T2     O2        1.5939        1.5895     -0.0044    2.0000     -0.0088



DLS-76        *** EXAMPLE 2 :  ANALCIME  ***  I4(1)/ACD   (WITH LINEAR RESTRICTIONS)   DATE: 24-MAY-95       PAGE  10




T2     O3        1.6215        1.6228      0.0014    2.0000      0.0027
T2     O3*       1.6202        1.6228      0.0026    2.0000      0.0053
O1     O2        2.6172        2.6002     -0.0170    1.0000     -0.0170
O1     O3        2.6336        2.6274     -0.0061    1.0000     -0.0061
O1     O3*       2.5626        2.6274      0.0648    1.0000      0.0648
O2     O3        2.5540        2.6230      0.0689    1.0000      0.0689
O2     O3*       2.6724        2.6229     -0.0495    1.0000     -0.0495
O3     O3*       2.7037        2.6501     -0.0536    1.0000     -0.0536
T1     T2        3.1363        3.1830      0.0466    0.1000      0.0047
T1     T2***     3.2503        3.1724     -0.0779    0.1000     -0.0078
T2     T2*       3.0258        3.0954      0.0696    0.1000      0.0070





R=SQRT( SUM(W*(DO-D))**2 / SUM(W*DO)**2 )=   0.01309653     BEFORE CYCLE   1
SIGMA=SQRT( SUM(W*(DO-D))**2 / (M-NV) )  =   0.06373119
RHO=SUM(W*(DO-D))**2 + SUM(W*COND)**2    =   0.02776967





PARAMETERS AFTER CYCLE   1

    PARAMETER      OLD       CHANGE      NEW                     PARAMETER      OLD       CHANGE      NEW

ATOM T1                                                      ATOM T2
       X         0.15809    0.00034    0.15843                      X         0.08416    0.00025    0.08441
       Y         0.09191   -0.00034    0.09157                      Y         0.12988   -0.00016    0.12972
       Z         0.12500    0.00000    0.12500                      Z         0.33777    0.00009    0.33786
ATOM O1                                                      ATOM O2
       X         0.10674    0.00048    0.10721                      X         0.13832    0.00028    0.13861
       Y         0.14997    0.00004    0.15001                      Y         0.03356    0.00006    0.03362
       Z         0.22574    0.00003    0.22576                      Z         0.37334   -0.00022    0.37312
ATOM O3
       X         0.12876    0.00020    0.12896
       Y         0.21675    0.00004    0.21679
       Z         0.40420    0.00021    0.40440


SYMMETRICALLY DEPENDENT ATOMS

ATOM      X        Y        Z

T1*    0.15843 -0.09157  0.37500
T2*    0.12028  0.33441  0.41214
T2**  -0.12028  0.16559  0.41214
T2***  0.37972  0.16559  0.08786
O1*    0.09999  0.14279  0.02424
O2*    0.28362  0.11139  0.12312
O2**   0.13861 -0.03362  0.12688
O3*   -0.03321  0.12104  0.34560



DLS-76        *** EXAMPLE 2 :  ANALCIME  ***  I4(1)/ACD   (WITH LINEAR RESTRICTIONS)   DATE: 24-MAY-95       PAGE  11





DIFFERENCE VECTORS TO INITIAL COORDINATES

ATOM           DX         DY         DZ

T1         -0.00365    0.00365    0.00000
T2         -0.00351    0.00472   -0.00006
O1          0.00293    0.01561    0.00644
O2         -0.00711    0.00294   -0.01128
O3         -0.00544   -0.00253    0.00868


LINEAR RESTRICTIONS AFTER CYCLE   1

NO OF CONDITION         C            WEIGHT*C  WEIGHT*C/NO OF TERMS

       1            -0.00008        -0.17064        -0.05688
       2             0.00136         3.24038         1.08013
       3            -0.00112        -2.32772        -0.77591
       4             0.00098         2.70768         0.90256


R=SQRT( SUM(W*(DO-D))**2 / SUM(W*DO)**2 )=   0.01303584     BEFORE CYCLE   2
SIGMA=SQRT( SUM(W*(DO-D))**2 / (M-NV) )  =   0.06343582
RHO=SUM(W*(DO-D))**2 + SUM(W*COND)**2    =   0.02749679


R=SQRT( SUM(W*(DO-D))**2 / SUM(W*DO)**2 )=   0.01302805     BEFORE CYCLE   3
SIGMA=SQRT( SUM(W*(DO-D))**2 / (M-NV) )  =   0.06339794
RHO=SUM(W*(DO-D))**2 + SUM(W*COND)**2    =   0.02749515

CONVERGENCE TEST POSITIVE AFTER CYCLE   3

APPROXIMATE EIGENVALUES OF MATRIX (LAST CYCLE):

 0.6954E+04 0.6194E+04 0.4178E+04 0.3184E+04 0.2706E+04 0.2442E+04 0.2142E+04 0.1362E+04 0.1004E+04 0.9471E+03
 0.4687E+03 0.2216E+03 0.1360E+03






PARAMETERS AFTER CYCLE   3

    PARAMETER      OLD       CHANGE      NEW                     PARAMETER      OLD       CHANGE      NEW

ATOM T1                                                      ATOM T2
       X         0.15839    0.00000    0.15839                      X         0.08440    0.00000    0.08440
       Y         0.09161    0.00000    0.09161                      Y         0.12974    0.00001    0.12976
       Z         0.12500    0.00000    0.12500                      Z         0.33783   -0.00001    0.33783
ATOM O1                                                      ATOM O2
       X         0.10726    0.00002    0.10728                      X         0.13857    0.00000    0.13857
       Y         0.15015    0.00003    0.15018                      Y         0.03358    0.00000    0.03358
       Z         0.22576    0.00000    0.22576                      Z         0.37300   -0.00003    0.37297



DLS-76        *** EXAMPLE 2 :  ANALCIME  ***  I4(1)/ACD   (WITH LINEAR RESTRICTIONS)   DATE: 24-MAY-95       PAGE  12




ATOM O3
       X         0.12892    0.00000    0.12892
       Y         0.21676    0.00000    0.21676
       Z         0.40449    0.00002    0.40450


SYMMETRICALLY DEPENDENT ATOMS

ATOM      X        Y        Z

T1*    0.15839 -0.09161  0.37500
T2*    0.12024  0.33440  0.41217
T2**  -0.12024  0.16560  0.41217
T2***  0.37976  0.16560  0.08783
O1*    0.09982  0.14272  0.02424
O2*    0.28358  0.11143  0.12297
O2**   0.13857 -0.03358  0.12703
O3*   -0.03324  0.12108  0.34550

DIFFERENCE VECTORS TO INITIAL COORDINATES

ATOM           DX         DY         DZ

T1         -0.00369    0.00369    0.00000
T2         -0.00352    0.00476   -0.00009
O1          0.00300    0.01578    0.00644
O2         -0.00715    0.00290   -0.01143
O3         -0.00548   -0.00256    0.00878


LINEAR RESTRICTIONS AFTER CYCLE   3

NO OF CONDITION         C            WEIGHT*C  WEIGHT*C/NO OF TERMS

       1            -0.00008        -0.17228        -0.05743
       2             0.00137         3.25666         1.08555
       3            -0.00113        -2.35053        -0.78351
       4             0.00098         2.71016         0.90339



INTERATOMIC DISTANCES BEFORE CYCLE   4 OF APID CYCLE  1

ATOM 1 ATOM 2 CALCULATED D PRESCRIBED DO     DO-D    WEIGHT     W*(DO-D)

T1     O1        1.7473        1.7420     -0.0052    2.0000     -0.0105
T1     O2*       1.7405        1.7365     -0.0040    2.0000     -0.0080
O1     O2*       2.8520        2.8403     -0.0118    1.0000     -0.0118
O1     O1*       2.7707        2.8448      0.0740    1.0000      0.0740
O1     O2**      2.8963        2.8403     -0.0560    1.0000     -0.0560
O2*    O2**      2.8162        2.8358      0.0195    1.0000      0.0195
T2     O1        1.5952        1.5950     -0.0002    2.0000     -0.0004
T2     O2        1.5905        1.5895     -0.0010    2.0000     -0.0019
T2     O3        1.6244        1.6228     -0.0015    2.0000     -0.0030
T2     O3*       1.6230        1.6228     -0.0002    2.0000     -0.0004



DLS-76        *** EXAMPLE 2 :  ANALCIME  ***  I4(1)/ACD   (WITH LINEAR RESTRICTIONS)   DATE: 24-MAY-95       PAGE  13




O1     O2        2.6140        2.6002     -0.0137    1.0000     -0.0137
O1     O3        2.6356        2.6274     -0.0081    1.0000     -0.0081
O1     O3*       2.5661        2.6274      0.0613    1.0000      0.0613
O2     O3        2.5554        2.6230      0.0676    1.0000      0.0676
O2     O3*       2.6741        2.6229     -0.0511    1.0000     -0.0511
O3     O3*       2.7091        2.6501     -0.0590    1.0000     -0.0590
T1     T2        3.1377        3.1830      0.0453    0.1000      0.0045
T1     T2***     3.2451        3.1724     -0.0726    0.1000     -0.0073
T2     T2*       3.0297        3.0954      0.0658    0.1000      0.0066





R=SQRT( SUM(W*(DO-D))**2 / SUM(W*DO)**2 )=   0.01302656     BEFORE CYCLE   4
SIGMA=SQRT( SUM(W*(DO-D))**2 / (M-NV) )  =   0.06339065
RHO=SUM(W*(DO-D))**2 + SUM(W*COND)**2    =   0.02749504



DLS-76        *** EXAMPLE 2 :  ANALCIME  ***  I4(1)/ACD   (WITH LINEAR RESTRICTIONS)   DATE: 24-MAY-95       PAGE  14




TOTAL PARAMETER SHIFTS AFTER LAST CYCLE

    PARAMETER    INITIAL     CHANGE      FINAL      SHIFT        PARAMETER    INITIAL     CHANGE      FINAL      SHIFT

ATOM T1                                                      ATOM T2
       X         0.16208   -0.00369    0.15839   -0.05071           X         0.08792   -0.00352    0.08440   -0.04835
       Y         0.08792    0.00369    0.09161    0.05071           Y         0.12500    0.00476    0.12976    0.06530
       Z         0.12500    0.00000    0.12500    0.00000           Z         0.33792   -0.00009    0.33783   -0.00129
       MAGNITUDE                                  0.07171           MAGNITUDE                                  0.08126
ATOM O1                                                      ATOM O2
       X         0.10428    0.00300    0.10728    0.04123           X         0.14572   -0.00715    0.13857   -0.09814
       Y         0.13440    0.01578    0.15018    0.21670           Y         0.03068    0.00290    0.03358    0.03985
       Z         0.21932    0.00644    0.22576    0.08845           Z         0.38440   -0.01143    0.37297   -0.15691
       MAGNITUDE                                  0.23766           MAGNITUDE                                  0.18931
ATOM O3
       X         0.13440   -0.00548    0.12892   -0.07529
       Y         0.21932   -0.00256    0.21676   -0.03520
       Z         0.39572    0.00878    0.40450    0.12058
       MAGNITUDE                                  0.14645           MAGNITUDE
------------------------------------------------------------------------

*** FINISH ***


</pre><hr><pre>
                                                               5-1
5. GLOSSARY OF SYMBOLS
----------------------

The dimensions of the arrays are given in the description of their
index variables. The index limits are defined in the subroutine
DATIN. Symbols marked with an asterisk are read as input data.


5.1 Control integers and single variables

The control integers on the DLS-76 card are explained in
Section 3.

* CORR             see FACTOR card cols. 61 - 70

* CVGTST           see FACTOR card cols. 31 - 40

  IA               Number of BONDIS cards (maximum value
                   is IDIMAP = 15 )

* ICAL             DLS-76 card col. 30

* ICOR             DLS-76 card col. 48

* IDIS             DLS-76 card col. 44

* IDOB             DLS-76 card col. 18

* IGIT             DLS-76 card col. 22

* IMAT             DLS-76 card col. 46

* INEW             DLS-76 card col. 10

* IORT             DLS-76 card col. 42

* IPCH             DLS-76 card col. 50

* IRNG             DLS-76 card col. 14

* IRNGl            Starting number of random generator
                   (FACTOR card cols. 26 - 30)

  ISYS             Internal crystal system indicator
                   (see DATIN)

* IVF              DLS-76 card cols. 32


</pre><hr><pre>
                                                               5-2

* LSYS             Crystal system indicator as on CELL card

  M                Number of distances (maximum value is
                   IDIMM = 200)

  N                Number of atoms (N1 + N2)

  N1               Number of atoms in asymmetric unit

  N2               Number of atoms outside asymmetric unit

* NA               DLS-76 card col. 26

* NAPID            DLS-76 card col. 20

* NC               DLS-76 card col. 24

* NCYCLE           DLS-76 card col. 16

* NDIAG            DLS-76 card col. 12

  NDO              Number of different prescribed ratios of
                   interatomic distances (maximum number of
                   ratios is IDIMRT = 40)

  NEQU             Number of SYMEQ cards (maximum value is
                   IDNEQU = 60)

* NFILEA           Logical number of parameter file

  NRE              Number of linear restrictions (maximum
                   value is IDIMLI = 35)

  NRH              Number of hard constraints

* NS               DLS-76 card col. 28

* NTIN             Logical number of card reader

  NTOUT            Logical number of line printer

  NV               Total number of variables (NVO + NVG +
                   NVD) (maximum value is IDIMNV = 150)

  NV1              NVO + NVG

  NVD              Number of distance variables


</pre><hr><pre>
                                                               5-3

  NVG              Number of lattice constant variables

  NVO              Number of coordinate variables

  NZA              Number of TETCON cards (maximum value
                   is IDIMNZ = 40)

  RDATE            Date

* RDD              RANGES card cols. 11 - 15

* ROTOL            RANGES card cols. 16 - 20

* ROTOU            RANGES card cols. 21 - 25

* RTOTL            RANGES card cols. 26 - 30

* RTOTU            RANGES card cols. 31 - 35

* WFAC             See FACTOR card cols. 51 - 60

* WRF              See FACTOR card cols. 41 - 50


5.2 Arrays

* A(6)             Lattice constants

* AOLD(6)          Lattice constants (of previous cycle)

  B(K,K,N)         (K = 1,3) homogeneous part of the
                   restrictions resulting from special
                   positions (for atoms in the asymmetric
                   unit only)

  BEDING(NRE)      Residual of the linear restriction NRE

  BI(K,N)          (K = 1,3) invariant part of restrictions
                   given by a special position (see B(K,K,N))

  BT(IA)           Bond type. Its value is calculated from
                   the atom type numbers of the 3 atoms
                   defining the bond type of a T-O bond.
                   (see subroutine DATIN)


</pre><hr><pre>
                                                               5-4

* CAPID(IA,4)      Parameters of distance function (see
                   BONDIS card)

  D(M)             Calculated interatomic distances

  DELTAD(M)        DOB(M) - D(M)

  DELV(NV)         Vector of parameter shifts of current
                   refinement cycle

  DGEL(NV)         Approximate eigenvalues of matrix

* DOB(M)           Prescribed interatomic distances

* DOBIN(M)         Initial values of prescribed interatomic
                   distances

  DOBOLD(M)        Prescribed interatomic distances of
                   previous APID cycle

* FUDGE(3)         Damping factors as stated on FACTOR card

  G(3,3)           Metric tensor


  GABL1(3,3,6)     First derivatives of metric tensor

  GABL2A(3,6,6)}
               }
  GABL2B(3,6,6)}   Second derivatives of metric tensor
               }
  GABL2C(3,6,6)}

  IBT(NZA,4)       Bond types of the four T-O distances of
                   central atom NZA

  ICON(NZA,11)     Tetrahedral connectivity of central atom
                   NZA

                   ICON(NZA,1 to 9) : internal representa-
                                      tion of TETCON card

                   ICON(NZA,10)     : number of non-equivalent
                                      T-O distances

                   ICON(NZA,11)     : number of non-equivalent
                                      O-O distances

* ID(N)            Label of atom N


</pre><hr><pre>
                                                               5-5

  IFAK(K,N)        Can have values D,I,L,R indicating whether
                   the coordinate K of atom number N is de-
                   pendent, invariant, dependent by a linear
                   restriction! or to be refined, respectively

  IFELD(6)         Number of cell parameters which are to
                   be refined (up to 6)

  IGIN(6)          Can have values D,I,R indicating whether
                   the corresponding cell parameter is de-
                   pendent, invariant, or to be refined,
                   respectively

* IMOV(3)          See DLS-76 card cols. 34 - 38

* ISYMB(M)         Symbol on DISTAN card which identifies
                   the reference distance in a constant ratio
                   refinement

* ITYPE(N)         Number of atom type of atom number N

  IV(NV)           Can have values of 1,2,3 indicating
                   whether the variable NV is an X, Y or Z
                   coordinate, respectively

  IV1(NV)          Contains the number of the atom to which
                   the variable NV belongs

  IZ1(NRE)         Number of terms in the linear restriction
                   NRE

  KA(K,NEQU)       (K = 1,2) Atom number of both atoms on
                   SYMEQ card NEQU

  KARI(NRE,IZ1)    Variable number corresponding to term IZ1 of the
                   linear restriction NRE

  KATOR(M)         Flag for the calculation of derivatives
                   of distance M (determined by subroutine
                   DATIN)

                   0     if both atoms are in the asymetric
                         unit and not on a special position


</pre><hr><pre>
                                                               5-6

                   -1    if atoms are not related and at least one
                         of them is not in the asymmetric unit, or
                         else at least one of them is in a secial
                         position


                   MYS>0 if both atoms are symmetrically related
                         (see SYMSIG(K,K,40))

KVAR(K,I1)         (K = 1,3). Contains the variable number
                   of coordinate K of atom N. If KVAR is
                   zero the coordinate is not to be refined.

KTYPE(NT)          Atom type symbol

LDR(NDO)           Variable number of prescribed distance
                   NDO in a constant ratio refinement

LIND(NRE)          Term number of the variable which is
                   eliminated in the hard constraint NRE

LINH(NRE)          If the linear restriction NRE is a hard
                   constraint, LINH(NRE) is 1, otherwise
                   it is 0.

LJ(M)              DOB(LJ(M)) is the prescribed distance
                   for distance D(M)

MD(NZA, 18)        Index to the D and DOB arrays of all
                   distances around central tetrahedral
                   atom NZA (inclusive outer O-T and T-T
                   distances)

                   MD(NZA, 1 to  4): T-01, T-02, T-03, T-04

                   MD(NZA, 5 to 10): 01-02, 01-03, 01-04
                                     02-03, 02-04, 03-04

                   MD(NZA,11 to 14): 01-T1, 02-T2, 03-T3,
                                     04-T4

                   MD(NZA,15 to 18): T-T1, T-T2, T-T3, T-T4


</pre><hr><pre>
                                                               5-7

  MSYMAB(N)        Number of atom in asymmetric unit, sym-
                   metrically equivalent to atom N

  MTR(N)           MTR(N) = N indicates that the atom N is
                   in a special position or outside the
                   asymmetric unit (otherwise MTR(N) = O)

  MW(M)            MW(M) = 2 if distance M is outside spe-
                   cified ranges, otherwise MW(M) = 1

  NN(M,K)          (K = 1,2). Number of the first or second
                   atom on DISTAN card number M

  NN11(M,K)        (K = 1,2). Number of the atom in the
                   asymmetrie unit to whieh atom K on DISTAN
                   eard M is symmetrically related

  OTO(NZA,6)       O-T-O angles at eentral atom NZA (in same
                   order as 0-0 distanees in MD(NZA,18) array)

  RAT(NDO)         Prescribed distance ratio (prescribed
                   distance/reference distance on DISTAN card)

* RESKO(NRE,IZ1)   Coefficient of term IZ1 of the linear
                   restriction NRE,(IZ1 IDIMIz = 20)

  S(NV*(NV+3)/2)   Matrix array. Only upper triangle is stored as
                   one-dimensional array

  SI(K,NEQU)       (K = 1,3). Translational part of symmetry
                   transformation of SYMEQ card number NEQU

  SIGN(K,K,NEQU)   (K = 1,3). Non-translational (homogeneous) part
                   of symmetry transformation of SYMEQ card number
                   NEQU

* SYMOPS(10,N)     Symmetry transformation (coded) as punched on
                   ATOM and SYMEQ cards

  SYMSIG(K,K,40)   (K = 1,3). This variable is only defined when
                   both atoms on a DISTAN card are symmetrically
                   equivalent, in which case


</pre><hr><pre>
                                                               5-8
                   SYMSIG(K,K,MYS) = B1 - B2

                   where B1 and B2 are the non-translational parts
                   of the symmetry transformations (including
                   restrictions due to special positions) leading
                   to ATOM1 and ATOM2, respectively

  T(NV)            Normal vector (gradient)

  TOT(NZA,4)       T-O-T angles observed at central atom
                   NZA (in same order as T-T distances in
                   MD (NZA,l8) array)

* W(M)             Weight of DOB (M)

* WEIGHT(IA,K)     (K = 1,3). Weights assigned to T-O, O-O and T-T
                   distances, respectively (see BONDIS card)

  WR (NRE)         Weight of linear restriction NRE

* X(K,N)           X, Y, Z coordinate (K = 1,3) of atom N

* XINI (K,N)       X, Y, Z coordinate (input values)

  XOLD(K,N)        X, Y, Z coordinate of previous cycle


</pre><hr><pre>
                                                               6-1
6. FORMULAE
-----------

In the following the more important formulae which form the
mathematical basis of DLS-76 are briefly surveyed. The symbols used
here and their names in the program are listed in Table 1 at the end
of this section.

Given a set of m weighted distance error equations and q weighted
linear restrictions or soft constraints (treated as additional
equations; cf. WASER, 1963) the following function #p(#v) must be
minimized.

                        FORMULA

where

                        FORMULA

#v shall represent a vector consisting of the variable atomic
coordinates zr' cell parameters as and (in a constant ratio
refinement) of variable prescribed distances Dt. If in addition to
the q soft constraints some coordinates are also subject to hard
constraints (i.e. restrictions which must be exactly fulfilled),
then an interatomic distance Dj may depend on additional coordinates
other than those of the two atoms directly involved.

The equation for the shift ##v towards a minimum of #p may be
given as

                        FORMULA

This can be approximated by

                        FORMULA


</pre><hr><pre>
                                                               6-2

or, if we set

                        FORMULA

by

                        FORMULA

The iteration

                        FORMULA

then takes the form

                        FORMULA

                        in the Newton-Raphson procedure

and

                        FORMULA

                        in the Gauss-Newton procedure.


In both procedures the vector #T contains in general the partial
derivatives of #p with respect to the coordinates zr', the cell
parameters ar and the variable prescribed distances Dr0:

                        FORMULA

where

                        FORMULA


</pre><hr><pre>
                                                               6-3

     An element Srs of the matrix S is given by

                        FORMULA

     in the Newton-Raphson procedure and as

                        FORMULA

     in the Gauss-Newton procedure where #pr and #ps are
     variables of the above three types.

     The following is a summary of all possible Srs.



Type of         Newton-Raphson          Gauss-Newton
Variables

                        FORMULA





</pre><hr><pre>
                                                               6-4

The distance D(P,Q) between the two atoms P and Q having
coordinates #x and #x' can be expressed by

                        FORMULA

Generally P and Q are outside the asymmetric unit and #x
and #x' can be given as

                        FORMULA

If P or Q occupy a special position, then B, #b or B', #b'
contain the information of the symmetry transformation
leading to P or Q as well as the relations describing the
special positions. (Symmetry information on SYMEQ-card and
on corresponding ATOM-card).

If a component yi of #y is not set invariant then yi = zk
for a given k, or

                        FORMULA

for a hard linear constraint l.

Hence, #x = #x - #x' may be understood as dependent on a
vector #z = (z1,...,zn)**T  of n variable coordinates.

If we define

                        FORMULA

and

                        FORMULA

we may write

                        FORMULA

where A is a (3 x n)-matrix.


</pre><hr><pre>
                                                               6-5

Hence, we obtain the following derivatives of D with respect
to coordinates and cell parameters.

                        FORMULA

In the calculation of A the program distinguishes three
cases

(i) P and Q are both in the asymmetric unit and in
    general position (indicated by KATOR(J) = 0)0 Then A has
    the form

                             (1 0 0-1 0 0)
                        A =  (0 1 0 0-1 0)
                             (0 0 1 0 0-1)

(ii) P and Q are symmetrically equivalent (KATOR(J)>0)
     Then #y = #y' and R = R' and A can be written as

                        A = (B - B')R

     (B - B' corresponds to SYMSIG(I,K,KATOR(J)))

(iii) P and/or Q are not in the asymmetric unit and/or in
      special positions (KATOR(J)<0):


                        A = BR - B'R'


</pre><hr><pre>
                                                               6-6
                          TABLE 1
                          -------

Symbol          Meaning                    Designation
in text                                    in program


A       matrix containing the deriva-      ALIN(I,K)
        tives of #x with respect to
        all variable coordinates on
        which #x depends

ar      variable cell parameter            A(I)
        number r

B       matrix containing the homoge-      B(I,K,N) (includes
        neous part of the symmetry         SIGN(I,K,NEQU))
        information on a SYMEQ card
        and the corresponding ATOM
        card

#b      vector representing the in-        SIGN(I,K,NEQU)*BI(K,N)
        homogeneous part of the sym-       + SI(I,NEQU)
        metry information

cl      linear constraint number l         BEDING(L)

Dj      calculated interatomic di-         D(J)
        stance

Dj0     prescribed distance                DOB(J)

Dr0     variable prescribed distance       DOB(LJ(J))

djr     ratio of Dj0 to Dr0                RAT(LJ(J))

#f,#p   auxiliary quantities in the
        representation of #p as a sum
        of two scalar products

gik     metric tensor                      G(I,K)

hlr     coefficient of term r in           RESKO(L,I)
        constraint l


</pre><hr><pre>
                                                               6-7

Symbol          Meaning                    Designation
in text                                    in program


m       number of distance equations       M

n       number of variable coordinates     KK
        on which a particular distance
        depends

#v      number of terms in constraint l    IZ1(L)

q       number of weighted (soft)          NRE-NRH
        constraints

R       auxiliary quantity: matrix
        containing the derivates of
        the yk with respect to all
        variable coordinates on which
        the yk depend

#p      function to be minimized           ROV

S       normal matrix/Jacobian matrix      S(KLM)
        of #p'

#T      vector of constants in system      T(I)
        represented by S

ul2     squared weight of soft con-        WR(L)
        straint

#v      vector composed of variables
        zr, as, Dt0

#v      shift of #v to be calculated in    DELV(I)
        an iteration cycle

wj2     squared weight of distance j       W(J)

#x      coordinates of an atom             X(K,N)


</pre><hr><pre>
                                                               6-8

Symbol          Meaning                    Designation
in text                                    in program



#x      difference of the coordinates      DELTAX(K)
        of two atoms belonging to a
        particular distance

#y      auxiliary quantity: vector
        composed of the free para-
        meters(1 which describe the
        position of a particular
        atom

#z      vector containing all va-
        riable coordinates on which
        a particular distance depends

zr      variable coordinate number r

zr0     initial value of zr





(1  In the sense that a dependence due to a linear restriction
    is allowed.


</pre><hr><pre>
                                                               7-1
7. REFERENCES
-------------

BARRER R.M. and VILLIGER H. (1969): The Crystal Structure of
        Synthetic Zeolite L. Z.Kristallogr. 128, 352-370.

BAUR W.H. (1977): Computer Simulation of Crystal Structures. Phys.
        Chem. Minerals. 2, 3-20.

BROWN G.E., GIBBS G.V. and RIBBE P.H. (1969): The Nature and
        Variation in Length of the Si-O and Al-O Bonds in
        Framework Silicates. Am. Mineral. 54, 1044-1061.

BUSING W.R. and LEVY H.A. (1962): A Procedure for Inverting Large
        Symmetric Matrices. Comm. ACM 5, 445-446.

DEMPSEY M.J. and STRENS R.G.J.(1976): Modelling Crystal Structures.
        In 'Physics and Chemistry of Minerals and Rocks' (R.G.J.
        Strens, Ed.; Wiley), pg. 443-458.

DOLLASE W.A. and BAUR W.H. (1976): The Superstructure of Meteoritic
        Low Tridymite Solved by Computer Simuiation. Am. Mineral.
        61, 971-978.

FERRARIS G., JONES D.W., and YERKESS J. (1972): A Neutrondiffraction
        Study of the Crystal Structure of Analcime, NaAlSi2O6 .
        H2O. Z.Kristallogr. 135, 240-252.

GRAMLICH V. and MEIER W.M. (1971): The Crystal Structure of Hydrated
        NaA: A Detailed Refinement of a Pseudosymmetric Zeolite
        Structure. Z.Kristallogr. 133, 134-149.

GUIGAS B. (1975): Verfeinerung von Kristallstrukturen mit dem
        Distance Least Squares-Verfahren: Behandlung von
        Konvergenzfragen und kristallographische Anwendungen.
        Doctoral Dissertation, University of Karlsruhe, BRD.

KHAN A.A. (1976): Computer Simulation of Thermal Expansion of Non-
        Cubic crystals: Forsterite, Anhydrite and Scheelite. Acta
        Cryst. A32, 11-16.


</pre><hr><pre>
                                                               7-2

LOUISNATHAN S.J. and GIBBS G.V. (1972): Bond Length Variation in TO4
        Tetrahedral Oxyanions of the Third Row Elements: T =
        Al,Si,P,S and Cl. Mat. Res. Bull. 7, 1281-1292.

MEIER W.M. (1973): Symmetry Aspects of Zeolite Frameworks. Adv.
        Chem. Ser. 121, 39-51.

MEIER W.M. and VILLIGER H. (1969): Die Methode der
        Abstandsverfeinerung zur Bestimmung der Atomkoordinaten
        idealisierter Gerueststrukturen. Z.Kristallogr. 129, 411-
        423.

SCHWARZENBACH D. (1966): Verfeinerung der Struktur der Tiefquarz-
        Modifikation von AlPO4. Z.Kristallogr. 123, 161-185.

TILLMANNS E., GEBERT W. and BAUR W.H. (1973): Computer Simulaticn of
        Crystal Structures Applied to the Solution of the
        Superstructure of Cubic Silicondiphosphate. J. Sol. State
        Chem. 7, 69-84.

VILLIGER H. (1969): DLS-Manual. Institut fuer Kristallographie und
        Petrographie, ETH Zuerich.

WASER J. (1963): Least-Squares Refinement with Subsidary Conditions.
        Acta Cryst. 16, 1091-1094.
</pre>

<hr>
<address>
Ch. Baerlocher,
Laboratory of Crystallography, ETH Z&uuml;rich, Switzerland.
<a href="mailto:ch.baerlocher@kristall.erdw.ethz.ch">
                ch.baerlocher@kristall.erdw.ethz.ch</a>
</address>

</body>

</html>
