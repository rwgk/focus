

      PROGRAM PFDATA
C
C     TO CREATE A DATA FILE  SCANDATA.DAT FROM CODPROF.DAT THAT IS 
C     COMPATIBLE WITH THE PROGRAM PEAKFIND.
C
      DIMENSION COUNTS(10000),ICTS(10000)
      CHARACTER*80 JUNK
      NTIN = 5
      NTOUT = 7
      ICMIN = 1000000
      ICMAX = 0
      DO 950 I=1,50
      READ(NTIN,900) JUNK
  900 FORMAT(A80)
      IF(JUNK(1:1).EQ.'F') GO TO 960
  950 CONTINUE    
  960 CONTINUE
      J=1
      DO 1200 I=1,10000
      READ(NTIN,1100,END=1300) TT,TCTS,SIG,BGD
 1100 FORMAT(F10.5,F12.0,F12.2,F12.3)
      IF(I.EQ.1) TT1 = TT
      IF(I.EQ.2) THEN
       TT2 = TT
       STEP = TT2 - TT1
      END IF
      IF(I.GE.3) THEN
       DIF = TT - TTO       
       IF(DIF.GT.(STEP+.000001)) THEN
        ISTP = NINT(DIF/STEP)
        X = (TCTS-BGD)*10.0 - COUNTS(J-1)
        DO 1150 K=1,ISTP-1
        COUNTS(J) = COUNTS(J-1) + X/ISTP
        J=J+1
 1150   CONTINUE
       END IF
      END IF
      TTO = TT
      COUNTS(J)=(TCTS-BGD)*10.0
      ICTS(J) = NINT(COUNTS(J))
      IF(ICTS(J).LT.ICMIN) ICMIN = ICTS(J)
      NPTS = J
      J=J+1
 1200 CONTINUE
 1300 CONTINUE
      L=1
      DO 1350 I = 1,NPTS
      ICTS(I) = ICTS(I) - ICMIN + 1
      IF(ICTS(I).EQ.ICTS(I-1)) THEN
         ICTS(I)=ICTS(I)+L
         L=L+1
         IF(L.GE.4) L=1
      ENDIF
      IF(ICTS(I).GT.ICMAX) ICMAX = ICTS(I)
 1350 CONTINUE
      DO 1400 I = 1,NPTS
 1400 ICTS(I) = NINT((FLOAT(ICTS(I))/FLOAT(ICMAX))*10000)
      WRITE(NTOUT,2000) (ICTS(I),I=1,NPTS)
 2000 FORMAT(1X,8I8)
      IEF=0
      WRITE(NTOUT,2000) IEF
      STOP
      END
