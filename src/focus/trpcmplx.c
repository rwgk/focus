static void trp16cmplx(int nx, int ny, int mya, const float *a,
                                       int mxb,       float *b)
{
  int          ix, iy, bxystep;
  const float  *ax0;
  const float  *axy0;
  const float  *axy1;
  const float  *axy2;
  const float  *axy3;
  const float  *axy4;
  const float  *axy5;
  const float  *axy6;
  const float  *axy7;
  const float  *axy8;
  const float  *axy9;
  const float  *axy10;
  const float  *axy11;
  const float  *axy12;
  const float  *axy13;
  const float  *axy14;
  const float  *axy15;
  float        *b0x;
  float        *byx;

  ax0 = a;
  b0x = b;
  ix = nx;
  for (; ix > (16 - 1); ix -= 16) {
    axy0 = ax0;
    axy1 = axy0 + mya;
    axy2 = axy1 + mya;
    axy3 = axy2 + mya;
    axy4 = axy3 + mya;
    axy5 = axy4 + mya;
    axy6 = axy5 + mya;
    axy7 = axy6 + mya;
    axy8 = axy7 + mya;
    axy9 = axy8 + mya;
    axy10 = axy9 + mya;
    axy11 = axy10 + mya;
    axy12 = axy11 + mya;
    axy13 = axy12 + mya;
    axy14 = axy13 + mya;
    axy15 = axy14 + mya;
    byx = b0x;
    iy = ny;
    bxystep = mxb - (2 * 16);
    for (; iy > (16 - 1); iy -= 16) {
      *byx++ = *axy0++;
      *byx++ = *axy0++;
      *byx++ = *axy1++;
      *byx++ = *axy1++;
      *byx++ = *axy2++;
      *byx++ = *axy2++;
      *byx++ = *axy3++;
      *byx++ = *axy3++;
      *byx++ = *axy4++;
      *byx++ = *axy4++;
      *byx++ = *axy5++;
      *byx++ = *axy5++;
      *byx++ = *axy6++;
      *byx++ = *axy6++;
      *byx++ = *axy7++;
      *byx++ = *axy7++;
      *byx++ = *axy8++;
      *byx++ = *axy8++;
      *byx++ = *axy9++;
      *byx++ = *axy9++;
      *byx++ = *axy10++;
      *byx++ = *axy10++;
      *byx++ = *axy11++;
      *byx++ = *axy11++;
      *byx++ = *axy12++;
      *byx++ = *axy12++;
      *byx++ = *axy13++;
      *byx++ = *axy13++;
      *byx++ = *axy14++;
      *byx++ = *axy14++;
      *byx++ = *axy15++;
      *byx++ = *axy15++;
       byx += bxystep;
      *byx++ = *axy0++;
      *byx++ = *axy0++;
      *byx++ = *axy1++;
      *byx++ = *axy1++;
      *byx++ = *axy2++;
      *byx++ = *axy2++;
      *byx++ = *axy3++;
      *byx++ = *axy3++;
      *byx++ = *axy4++;
      *byx++ = *axy4++;
      *byx++ = *axy5++;
      *byx++ = *axy5++;
      *byx++ = *axy6++;
      *byx++ = *axy6++;
      *byx++ = *axy7++;
      *byx++ = *axy7++;
      *byx++ = *axy8++;
      *byx++ = *axy8++;
      *byx++ = *axy9++;
      *byx++ = *axy9++;
      *byx++ = *axy10++;
      *byx++ = *axy10++;
      *byx++ = *axy11++;
      *byx++ = *axy11++;
      *byx++ = *axy12++;
      *byx++ = *axy12++;
      *byx++ = *axy13++;
      *byx++ = *axy13++;
      *byx++ = *axy14++;
      *byx++ = *axy14++;
      *byx++ = *axy15++;
      *byx++ = *axy15++;
       byx += bxystep;
      *byx++ = *axy0++;
      *byx++ = *axy0++;
      *byx++ = *axy1++;
      *byx++ = *axy1++;
      *byx++ = *axy2++;
      *byx++ = *axy2++;
      *byx++ = *axy3++;
      *byx++ = *axy3++;
      *byx++ = *axy4++;
      *byx++ = *axy4++;
      *byx++ = *axy5++;
      *byx++ = *axy5++;
      *byx++ = *axy6++;
      *byx++ = *axy6++;
      *byx++ = *axy7++;
      *byx++ = *axy7++;
      *byx++ = *axy8++;
      *byx++ = *axy8++;
      *byx++ = *axy9++;
      *byx++ = *axy9++;
      *byx++ = *axy10++;
      *byx++ = *axy10++;
      *byx++ = *axy11++;
      *byx++ = *axy11++;
      *byx++ = *axy12++;
      *byx++ = *axy12++;
      *byx++ = *axy13++;
      *byx++ = *axy13++;
      *byx++ = *axy14++;
      *byx++ = *axy14++;
      *byx++ = *axy15++;
      *byx++ = *axy15++;
       byx += bxystep;
      *byx++ = *axy0++;
      *byx++ = *axy0++;
      *byx++ = *axy1++;
      *byx++ = *axy1++;
      *byx++ = *axy2++;
      *byx++ = *axy2++;
      *byx++ = *axy3++;
      *byx++ = *axy3++;
      *byx++ = *axy4++;
      *byx++ = *axy4++;
      *byx++ = *axy5++;
      *byx++ = *axy5++;
      *byx++ = *axy6++;
      *byx++ = *axy6++;
      *byx++ = *axy7++;
      *byx++ = *axy7++;
      *byx++ = *axy8++;
      *byx++ = *axy8++;
      *byx++ = *axy9++;
      *byx++ = *axy9++;
      *byx++ = *axy10++;
      *byx++ = *axy10++;
      *byx++ = *axy11++;
      *byx++ = *axy11++;
      *byx++ = *axy12++;
      *byx++ = *axy12++;
      *byx++ = *axy13++;
      *byx++ = *axy13++;
      *byx++ = *axy14++;
      *byx++ = *axy14++;
      *byx++ = *axy15++;
      *byx++ = *axy15++;
       byx += bxystep;
      *byx++ = *axy0++;
      *byx++ = *axy0++;
      *byx++ = *axy1++;
      *byx++ = *axy1++;
      *byx++ = *axy2++;
      *byx++ = *axy2++;
      *byx++ = *axy3++;
      *byx++ = *axy3++;
      *byx++ = *axy4++;
      *byx++ = *axy4++;
      *byx++ = *axy5++;
      *byx++ = *axy5++;
      *byx++ = *axy6++;
      *byx++ = *axy6++;
      *byx++ = *axy7++;
      *byx++ = *axy7++;
      *byx++ = *axy8++;
      *byx++ = *axy8++;
      *byx++ = *axy9++;
      *byx++ = *axy9++;
      *byx++ = *axy10++;
      *byx++ = *axy10++;
      *byx++ = *axy11++;
      *byx++ = *axy11++;
      *byx++ = *axy12++;
      *byx++ = *axy12++;
      *byx++ = *axy13++;
      *byx++ = *axy13++;
      *byx++ = *axy14++;
      *byx++ = *axy14++;
      *byx++ = *axy15++;
      *byx++ = *axy15++;
       byx += bxystep;
      *byx++ = *axy0++;
      *byx++ = *axy0++;
      *byx++ = *axy1++;
      *byx++ = *axy1++;
      *byx++ = *axy2++;
      *byx++ = *axy2++;
      *byx++ = *axy3++;
      *byx++ = *axy3++;
      *byx++ = *axy4++;
      *byx++ = *axy4++;
      *byx++ = *axy5++;
      *byx++ = *axy5++;
      *byx++ = *axy6++;
      *byx++ = *axy6++;
      *byx++ = *axy7++;
      *byx++ = *axy7++;
      *byx++ = *axy8++;
      *byx++ = *axy8++;
      *byx++ = *axy9++;
      *byx++ = *axy9++;
      *byx++ = *axy10++;
      *byx++ = *axy10++;
      *byx++ = *axy11++;
      *byx++ = *axy11++;
      *byx++ = *axy12++;
      *byx++ = *axy12++;
      *byx++ = *axy13++;
      *byx++ = *axy13++;
      *byx++ = *axy14++;
      *byx++ = *axy14++;
      *byx++ = *axy15++;
      *byx++ = *axy15++;
       byx += bxystep;
      *byx++ = *axy0++;
      *byx++ = *axy0++;
      *byx++ = *axy1++;
      *byx++ = *axy1++;
      *byx++ = *axy2++;
      *byx++ = *axy2++;
      *byx++ = *axy3++;
      *byx++ = *axy3++;
      *byx++ = *axy4++;
      *byx++ = *axy4++;
      *byx++ = *axy5++;
      *byx++ = *axy5++;
      *byx++ = *axy6++;
      *byx++ = *axy6++;
      *byx++ = *axy7++;
      *byx++ = *axy7++;
      *byx++ = *axy8++;
      *byx++ = *axy8++;
      *byx++ = *axy9++;
      *byx++ = *axy9++;
      *byx++ = *axy10++;
      *byx++ = *axy10++;
      *byx++ = *axy11++;
      *byx++ = *axy11++;
      *byx++ = *axy12++;
      *byx++ = *axy12++;
      *byx++ = *axy13++;
      *byx++ = *axy13++;
      *byx++ = *axy14++;
      *byx++ = *axy14++;
      *byx++ = *axy15++;
      *byx++ = *axy15++;
       byx += bxystep;
      *byx++ = *axy0++;
      *byx++ = *axy0++;
      *byx++ = *axy1++;
      *byx++ = *axy1++;
      *byx++ = *axy2++;
      *byx++ = *axy2++;
      *byx++ = *axy3++;
      *byx++ = *axy3++;
      *byx++ = *axy4++;
      *byx++ = *axy4++;
      *byx++ = *axy5++;
      *byx++ = *axy5++;
      *byx++ = *axy6++;
      *byx++ = *axy6++;
      *byx++ = *axy7++;
      *byx++ = *axy7++;
      *byx++ = *axy8++;
      *byx++ = *axy8++;
      *byx++ = *axy9++;
      *byx++ = *axy9++;
      *byx++ = *axy10++;
      *byx++ = *axy10++;
      *byx++ = *axy11++;
      *byx++ = *axy11++;
      *byx++ = *axy12++;
      *byx++ = *axy12++;
      *byx++ = *axy13++;
      *byx++ = *axy13++;
      *byx++ = *axy14++;
      *byx++ = *axy14++;
      *byx++ = *axy15++;
      *byx++ = *axy15++;
       byx += bxystep;
      *byx++ = *axy0++;
      *byx++ = *axy0++;
      *byx++ = *axy1++;
      *byx++ = *axy1++;
      *byx++ = *axy2++;
      *byx++ = *axy2++;
      *byx++ = *axy3++;
      *byx++ = *axy3++;
      *byx++ = *axy4++;
      *byx++ = *axy4++;
      *byx++ = *axy5++;
      *byx++ = *axy5++;
      *byx++ = *axy6++;
      *byx++ = *axy6++;
      *byx++ = *axy7++;
      *byx++ = *axy7++;
      *byx++ = *axy8++;
      *byx++ = *axy8++;
      *byx++ = *axy9++;
      *byx++ = *axy9++;
      *byx++ = *axy10++;
      *byx++ = *axy10++;
      *byx++ = *axy11++;
      *byx++ = *axy11++;
      *byx++ = *axy12++;
      *byx++ = *axy12++;
      *byx++ = *axy13++;
      *byx++ = *axy13++;
      *byx++ = *axy14++;
      *byx++ = *axy14++;
      *byx++ = *axy15++;
      *byx++ = *axy15++;
       byx += bxystep;
      *byx++ = *axy0++;
      *byx++ = *axy0++;
      *byx++ = *axy1++;
      *byx++ = *axy1++;
      *byx++ = *axy2++;
      *byx++ = *axy2++;
      *byx++ = *axy3++;
      *byx++ = *axy3++;
      *byx++ = *axy4++;
      *byx++ = *axy4++;
      *byx++ = *axy5++;
      *byx++ = *axy5++;
      *byx++ = *axy6++;
      *byx++ = *axy6++;
      *byx++ = *axy7++;
      *byx++ = *axy7++;
      *byx++ = *axy8++;
      *byx++ = *axy8++;
      *byx++ = *axy9++;
      *byx++ = *axy9++;
      *byx++ = *axy10++;
      *byx++ = *axy10++;
      *byx++ = *axy11++;
      *byx++ = *axy11++;
      *byx++ = *axy12++;
      *byx++ = *axy12++;
      *byx++ = *axy13++;
      *byx++ = *axy13++;
      *byx++ = *axy14++;
      *byx++ = *axy14++;
      *byx++ = *axy15++;
      *byx++ = *axy15++;
       byx += bxystep;
      *byx++ = *axy0++;
      *byx++ = *axy0++;
      *byx++ = *axy1++;
      *byx++ = *axy1++;
      *byx++ = *axy2++;
      *byx++ = *axy2++;
      *byx++ = *axy3++;
      *byx++ = *axy3++;
      *byx++ = *axy4++;
      *byx++ = *axy4++;
      *byx++ = *axy5++;
      *byx++ = *axy5++;
      *byx++ = *axy6++;
      *byx++ = *axy6++;
      *byx++ = *axy7++;
      *byx++ = *axy7++;
      *byx++ = *axy8++;
      *byx++ = *axy8++;
      *byx++ = *axy9++;
      *byx++ = *axy9++;
      *byx++ = *axy10++;
      *byx++ = *axy10++;
      *byx++ = *axy11++;
      *byx++ = *axy11++;
      *byx++ = *axy12++;
      *byx++ = *axy12++;
      *byx++ = *axy13++;
      *byx++ = *axy13++;
      *byx++ = *axy14++;
      *byx++ = *axy14++;
      *byx++ = *axy15++;
      *byx++ = *axy15++;
       byx += bxystep;
      *byx++ = *axy0++;
      *byx++ = *axy0++;
      *byx++ = *axy1++;
      *byx++ = *axy1++;
      *byx++ = *axy2++;
      *byx++ = *axy2++;
      *byx++ = *axy3++;
      *byx++ = *axy3++;
      *byx++ = *axy4++;
      *byx++ = *axy4++;
      *byx++ = *axy5++;
      *byx++ = *axy5++;
      *byx++ = *axy6++;
      *byx++ = *axy6++;
      *byx++ = *axy7++;
      *byx++ = *axy7++;
      *byx++ = *axy8++;
      *byx++ = *axy8++;
      *byx++ = *axy9++;
      *byx++ = *axy9++;
      *byx++ = *axy10++;
      *byx++ = *axy10++;
      *byx++ = *axy11++;
      *byx++ = *axy11++;
      *byx++ = *axy12++;
      *byx++ = *axy12++;
      *byx++ = *axy13++;
      *byx++ = *axy13++;
      *byx++ = *axy14++;
      *byx++ = *axy14++;
      *byx++ = *axy15++;
      *byx++ = *axy15++;
       byx += bxystep;
      *byx++ = *axy0++;
      *byx++ = *axy0++;
      *byx++ = *axy1++;
      *byx++ = *axy1++;
      *byx++ = *axy2++;
      *byx++ = *axy2++;
      *byx++ = *axy3++;
      *byx++ = *axy3++;
      *byx++ = *axy4++;
      *byx++ = *axy4++;
      *byx++ = *axy5++;
      *byx++ = *axy5++;
      *byx++ = *axy6++;
      *byx++ = *axy6++;
      *byx++ = *axy7++;
      *byx++ = *axy7++;
      *byx++ = *axy8++;
      *byx++ = *axy8++;
      *byx++ = *axy9++;
      *byx++ = *axy9++;
      *byx++ = *axy10++;
      *byx++ = *axy10++;
      *byx++ = *axy11++;
      *byx++ = *axy11++;
      *byx++ = *axy12++;
      *byx++ = *axy12++;
      *byx++ = *axy13++;
      *byx++ = *axy13++;
      *byx++ = *axy14++;
      *byx++ = *axy14++;
      *byx++ = *axy15++;
      *byx++ = *axy15++;
       byx += bxystep;
      *byx++ = *axy0++;
      *byx++ = *axy0++;
      *byx++ = *axy1++;
      *byx++ = *axy1++;
      *byx++ = *axy2++;
      *byx++ = *axy2++;
      *byx++ = *axy3++;
      *byx++ = *axy3++;
      *byx++ = *axy4++;
      *byx++ = *axy4++;
      *byx++ = *axy5++;
      *byx++ = *axy5++;
      *byx++ = *axy6++;
      *byx++ = *axy6++;
      *byx++ = *axy7++;
      *byx++ = *axy7++;
      *byx++ = *axy8++;
      *byx++ = *axy8++;
      *byx++ = *axy9++;
      *byx++ = *axy9++;
      *byx++ = *axy10++;
      *byx++ = *axy10++;
      *byx++ = *axy11++;
      *byx++ = *axy11++;
      *byx++ = *axy12++;
      *byx++ = *axy12++;
      *byx++ = *axy13++;
      *byx++ = *axy13++;
      *byx++ = *axy14++;
      *byx++ = *axy14++;
      *byx++ = *axy15++;
      *byx++ = *axy15++;
       byx += bxystep;
      *byx++ = *axy0++;
      *byx++ = *axy0++;
      *byx++ = *axy1++;
      *byx++ = *axy1++;
      *byx++ = *axy2++;
      *byx++ = *axy2++;
      *byx++ = *axy3++;
      *byx++ = *axy3++;
      *byx++ = *axy4++;
      *byx++ = *axy4++;
      *byx++ = *axy5++;
      *byx++ = *axy5++;
      *byx++ = *axy6++;
      *byx++ = *axy6++;
      *byx++ = *axy7++;
      *byx++ = *axy7++;
      *byx++ = *axy8++;
      *byx++ = *axy8++;
      *byx++ = *axy9++;
      *byx++ = *axy9++;
      *byx++ = *axy10++;
      *byx++ = *axy10++;
      *byx++ = *axy11++;
      *byx++ = *axy11++;
      *byx++ = *axy12++;
      *byx++ = *axy12++;
      *byx++ = *axy13++;
      *byx++ = *axy13++;
      *byx++ = *axy14++;
      *byx++ = *axy14++;
      *byx++ = *axy15++;
      *byx++ = *axy15++;
       byx += bxystep;
      *byx++ = *axy0++;
      *byx++ = *axy0++;
      *byx++ = *axy1++;
      *byx++ = *axy1++;
      *byx++ = *axy2++;
      *byx++ = *axy2++;
      *byx++ = *axy3++;
      *byx++ = *axy3++;
      *byx++ = *axy4++;
      *byx++ = *axy4++;
      *byx++ = *axy5++;
      *byx++ = *axy5++;
      *byx++ = *axy6++;
      *byx++ = *axy6++;
      *byx++ = *axy7++;
      *byx++ = *axy7++;
      *byx++ = *axy8++;
      *byx++ = *axy8++;
      *byx++ = *axy9++;
      *byx++ = *axy9++;
      *byx++ = *axy10++;
      *byx++ = *axy10++;
      *byx++ = *axy11++;
      *byx++ = *axy11++;
      *byx++ = *axy12++;
      *byx++ = *axy12++;
      *byx++ = *axy13++;
      *byx++ = *axy13++;
      *byx++ = *axy14++;
      *byx++ = *axy14++;
      *byx++ = *axy15++;
      *byx++ = *axy15++;
       byx += bxystep;
    }
    bxystep = mxb - (2 * 16);
    for (; iy > (1 - 1); iy -= 1) {
      *byx++ = *axy0++;
      *byx++ = *axy0++;
      *byx++ = *axy1++;
      *byx++ = *axy1++;
      *byx++ = *axy2++;
      *byx++ = *axy2++;
      *byx++ = *axy3++;
      *byx++ = *axy3++;
      *byx++ = *axy4++;
      *byx++ = *axy4++;
      *byx++ = *axy5++;
      *byx++ = *axy5++;
      *byx++ = *axy6++;
      *byx++ = *axy6++;
      *byx++ = *axy7++;
      *byx++ = *axy7++;
      *byx++ = *axy8++;
      *byx++ = *axy8++;
      *byx++ = *axy9++;
      *byx++ = *axy9++;
      *byx++ = *axy10++;
      *byx++ = *axy10++;
      *byx++ = *axy11++;
      *byx++ = *axy11++;
      *byx++ = *axy12++;
      *byx++ = *axy12++;
      *byx++ = *axy13++;
      *byx++ = *axy13++;
      *byx++ = *axy14++;
      *byx++ = *axy14++;
      *byx++ = *axy15++;
      *byx++ = *axy15++;
       byx += bxystep;
    }
    ax0 += 16 * mya;
    b0x += (2 * 16);
  }
  for (; ix > (1 - 1); ix -= 1) {
    axy0 = ax0;
    byx = b0x;
    iy = ny;
    bxystep = mxb - (2 * 1);
    for (; iy > (16 - 1); iy -= 16) {
      *byx++ = *axy0++;
      *byx++ = *axy0++;
       byx += bxystep;
      *byx++ = *axy0++;
      *byx++ = *axy0++;
       byx += bxystep;
      *byx++ = *axy0++;
      *byx++ = *axy0++;
       byx += bxystep;
      *byx++ = *axy0++;
      *byx++ = *axy0++;
       byx += bxystep;
      *byx++ = *axy0++;
      *byx++ = *axy0++;
       byx += bxystep;
      *byx++ = *axy0++;
      *byx++ = *axy0++;
       byx += bxystep;
      *byx++ = *axy0++;
      *byx++ = *axy0++;
       byx += bxystep;
      *byx++ = *axy0++;
      *byx++ = *axy0++;
       byx += bxystep;
      *byx++ = *axy0++;
      *byx++ = *axy0++;
       byx += bxystep;
      *byx++ = *axy0++;
      *byx++ = *axy0++;
       byx += bxystep;
      *byx++ = *axy0++;
      *byx++ = *axy0++;
       byx += bxystep;
      *byx++ = *axy0++;
      *byx++ = *axy0++;
       byx += bxystep;
      *byx++ = *axy0++;
      *byx++ = *axy0++;
       byx += bxystep;
      *byx++ = *axy0++;
      *byx++ = *axy0++;
       byx += bxystep;
      *byx++ = *axy0++;
      *byx++ = *axy0++;
       byx += bxystep;
      *byx++ = *axy0++;
      *byx++ = *axy0++;
       byx += bxystep;
    }
    bxystep = mxb - (2 * 1);
    for (; iy > (1 - 1); iy -= 1) {
      *byx++ = *axy0++;
      *byx++ = *axy0++;
       byx += bxystep;
    }
    ax0 += mya;
    b0x += 2;
  }
}


static void trp08cmplx(int nx, int ny, int mya, const float *a,
                                       int mxb,       float *b)
{
  int          ix, iy, bxystep;
  const float  *ax0;
  const float  *axy0;
  const float  *axy1;
  const float  *axy2;
  const float  *axy3;
  const float  *axy4;
  const float  *axy5;
  const float  *axy6;
  const float  *axy7;
  float        *b0x;
  float        *byx;

  ax0 = a;
  b0x = b;
  ix = nx;
  for (; ix > (8 - 1); ix -= 8) {
    axy0 = ax0;
    axy1 = axy0 + mya;
    axy2 = axy1 + mya;
    axy3 = axy2 + mya;
    axy4 = axy3 + mya;
    axy5 = axy4 + mya;
    axy6 = axy5 + mya;
    axy7 = axy6 + mya;
    byx = b0x;
    iy = ny;
    bxystep = mxb - (2 * 8);
    for (; iy > (8 - 1); iy -= 8) {
      *byx++ = *axy0++;
      *byx++ = *axy0++;
      *byx++ = *axy1++;
      *byx++ = *axy1++;
      *byx++ = *axy2++;
      *byx++ = *axy2++;
      *byx++ = *axy3++;
      *byx++ = *axy3++;
      *byx++ = *axy4++;
      *byx++ = *axy4++;
      *byx++ = *axy5++;
      *byx++ = *axy5++;
      *byx++ = *axy6++;
      *byx++ = *axy6++;
      *byx++ = *axy7++;
      *byx++ = *axy7++;
       byx += bxystep;
      *byx++ = *axy0++;
      *byx++ = *axy0++;
      *byx++ = *axy1++;
      *byx++ = *axy1++;
      *byx++ = *axy2++;
      *byx++ = *axy2++;
      *byx++ = *axy3++;
      *byx++ = *axy3++;
      *byx++ = *axy4++;
      *byx++ = *axy4++;
      *byx++ = *axy5++;
      *byx++ = *axy5++;
      *byx++ = *axy6++;
      *byx++ = *axy6++;
      *byx++ = *axy7++;
      *byx++ = *axy7++;
       byx += bxystep;
      *byx++ = *axy0++;
      *byx++ = *axy0++;
      *byx++ = *axy1++;
      *byx++ = *axy1++;
      *byx++ = *axy2++;
      *byx++ = *axy2++;
      *byx++ = *axy3++;
      *byx++ = *axy3++;
      *byx++ = *axy4++;
      *byx++ = *axy4++;
      *byx++ = *axy5++;
      *byx++ = *axy5++;
      *byx++ = *axy6++;
      *byx++ = *axy6++;
      *byx++ = *axy7++;
      *byx++ = *axy7++;
       byx += bxystep;
      *byx++ = *axy0++;
      *byx++ = *axy0++;
      *byx++ = *axy1++;
      *byx++ = *axy1++;
      *byx++ = *axy2++;
      *byx++ = *axy2++;
      *byx++ = *axy3++;
      *byx++ = *axy3++;
      *byx++ = *axy4++;
      *byx++ = *axy4++;
      *byx++ = *axy5++;
      *byx++ = *axy5++;
      *byx++ = *axy6++;
      *byx++ = *axy6++;
      *byx++ = *axy7++;
      *byx++ = *axy7++;
       byx += bxystep;
      *byx++ = *axy0++;
      *byx++ = *axy0++;
      *byx++ = *axy1++;
      *byx++ = *axy1++;
      *byx++ = *axy2++;
      *byx++ = *axy2++;
      *byx++ = *axy3++;
      *byx++ = *axy3++;
      *byx++ = *axy4++;
      *byx++ = *axy4++;
      *byx++ = *axy5++;
      *byx++ = *axy5++;
      *byx++ = *axy6++;
      *byx++ = *axy6++;
      *byx++ = *axy7++;
      *byx++ = *axy7++;
       byx += bxystep;
      *byx++ = *axy0++;
      *byx++ = *axy0++;
      *byx++ = *axy1++;
      *byx++ = *axy1++;
      *byx++ = *axy2++;
      *byx++ = *axy2++;
      *byx++ = *axy3++;
      *byx++ = *axy3++;
      *byx++ = *axy4++;
      *byx++ = *axy4++;
      *byx++ = *axy5++;
      *byx++ = *axy5++;
      *byx++ = *axy6++;
      *byx++ = *axy6++;
      *byx++ = *axy7++;
      *byx++ = *axy7++;
       byx += bxystep;
      *byx++ = *axy0++;
      *byx++ = *axy0++;
      *byx++ = *axy1++;
      *byx++ = *axy1++;
      *byx++ = *axy2++;
      *byx++ = *axy2++;
      *byx++ = *axy3++;
      *byx++ = *axy3++;
      *byx++ = *axy4++;
      *byx++ = *axy4++;
      *byx++ = *axy5++;
      *byx++ = *axy5++;
      *byx++ = *axy6++;
      *byx++ = *axy6++;
      *byx++ = *axy7++;
      *byx++ = *axy7++;
       byx += bxystep;
      *byx++ = *axy0++;
      *byx++ = *axy0++;
      *byx++ = *axy1++;
      *byx++ = *axy1++;
      *byx++ = *axy2++;
      *byx++ = *axy2++;
      *byx++ = *axy3++;
      *byx++ = *axy3++;
      *byx++ = *axy4++;
      *byx++ = *axy4++;
      *byx++ = *axy5++;
      *byx++ = *axy5++;
      *byx++ = *axy6++;
      *byx++ = *axy6++;
      *byx++ = *axy7++;
      *byx++ = *axy7++;
       byx += bxystep;
    }
    bxystep = mxb - (2 * 8);
    for (; iy > (1 - 1); iy -= 1) {
      *byx++ = *axy0++;
      *byx++ = *axy0++;
      *byx++ = *axy1++;
      *byx++ = *axy1++;
      *byx++ = *axy2++;
      *byx++ = *axy2++;
      *byx++ = *axy3++;
      *byx++ = *axy3++;
      *byx++ = *axy4++;
      *byx++ = *axy4++;
      *byx++ = *axy5++;
      *byx++ = *axy5++;
      *byx++ = *axy6++;
      *byx++ = *axy6++;
      *byx++ = *axy7++;
      *byx++ = *axy7++;
       byx += bxystep;
    }
    ax0 += 8 * mya;
    b0x += (2 * 8);
  }
  for (; ix > (1 - 1); ix -= 1) {
    axy0 = ax0;
    byx = b0x;
    iy = ny;
    bxystep = mxb - (2 * 1);
    for (; iy > (8 - 1); iy -= 8) {
      *byx++ = *axy0++;
      *byx++ = *axy0++;
       byx += bxystep;
      *byx++ = *axy0++;
      *byx++ = *axy0++;
       byx += bxystep;
      *byx++ = *axy0++;
      *byx++ = *axy0++;
       byx += bxystep;
      *byx++ = *axy0++;
      *byx++ = *axy0++;
       byx += bxystep;
      *byx++ = *axy0++;
      *byx++ = *axy0++;
       byx += bxystep;
      *byx++ = *axy0++;
      *byx++ = *axy0++;
       byx += bxystep;
      *byx++ = *axy0++;
      *byx++ = *axy0++;
       byx += bxystep;
      *byx++ = *axy0++;
      *byx++ = *axy0++;
       byx += bxystep;
    }
    bxystep = mxb - (2 * 1);
    for (; iy > (1 - 1); iy -= 1) {
      *byx++ = *axy0++;
      *byx++ = *axy0++;
       byx += bxystep;
    }
    ax0 += mya;
    b0x += 2;
  }
}


static void trp04cmplx(int nx, int ny, int mya, const float *a,
                                       int mxb,       float *b)
{
  int          ix, iy, bxystep;
  const float  *ax0;
  const float  *axy0;
  const float  *axy1;
  const float  *axy2;
  const float  *axy3;
  float        *b0x;
  float        *byx;

  ax0 = a;
  b0x = b;
  ix = nx;
  for (; ix > (4 - 1); ix -= 4) {
    axy0 = ax0;
    axy1 = axy0 + mya;
    axy2 = axy1 + mya;
    axy3 = axy2 + mya;
    byx = b0x;
    iy = ny;
    bxystep = mxb - (2 * 4);
    for (; iy > (4 - 1); iy -= 4) {
      *byx++ = *axy0++;
      *byx++ = *axy0++;
      *byx++ = *axy1++;
      *byx++ = *axy1++;
      *byx++ = *axy2++;
      *byx++ = *axy2++;
      *byx++ = *axy3++;
      *byx++ = *axy3++;
       byx += bxystep;
      *byx++ = *axy0++;
      *byx++ = *axy0++;
      *byx++ = *axy1++;
      *byx++ = *axy1++;
      *byx++ = *axy2++;
      *byx++ = *axy2++;
      *byx++ = *axy3++;
      *byx++ = *axy3++;
       byx += bxystep;
      *byx++ = *axy0++;
      *byx++ = *axy0++;
      *byx++ = *axy1++;
      *byx++ = *axy1++;
      *byx++ = *axy2++;
      *byx++ = *axy2++;
      *byx++ = *axy3++;
      *byx++ = *axy3++;
       byx += bxystep;
      *byx++ = *axy0++;
      *byx++ = *axy0++;
      *byx++ = *axy1++;
      *byx++ = *axy1++;
      *byx++ = *axy2++;
      *byx++ = *axy2++;
      *byx++ = *axy3++;
      *byx++ = *axy3++;
       byx += bxystep;
    }
    bxystep = mxb - (2 * 4);
    for (; iy > (1 - 1); iy -= 1) {
      *byx++ = *axy0++;
      *byx++ = *axy0++;
      *byx++ = *axy1++;
      *byx++ = *axy1++;
      *byx++ = *axy2++;
      *byx++ = *axy2++;
      *byx++ = *axy3++;
      *byx++ = *axy3++;
       byx += bxystep;
    }
    ax0 += 4 * mya;
    b0x += (2 * 4);
  }
  for (; ix > (1 - 1); ix -= 1) {
    axy0 = ax0;
    byx = b0x;
    iy = ny;
    bxystep = mxb - (2 * 1);
    for (; iy > (4 - 1); iy -= 4) {
      *byx++ = *axy0++;
      *byx++ = *axy0++;
       byx += bxystep;
      *byx++ = *axy0++;
      *byx++ = *axy0++;
       byx += bxystep;
      *byx++ = *axy0++;
      *byx++ = *axy0++;
       byx += bxystep;
      *byx++ = *axy0++;
      *byx++ = *axy0++;
       byx += bxystep;
    }
    bxystep = mxb - (2 * 1);
    for (; iy > (1 - 1); iy -= 1) {
      *byx++ = *axy0++;
      *byx++ = *axy0++;
       byx += bxystep;
    }
    ax0 += mya;
    b0x += 2;
  }
}


void trpcmplx(int nx, int ny, int mya, const float *a,
                              int mxb,       float *b)
{
  int        ix, iy, dx, dy;
  const int  blocksize = 16;

  void (*trpfx)(int, int, int, const float *,
                          int,       float *);
  void (*trpfy)(int, int, int, const float *,
                          int,       float *);


  if (blocksize > 15) trpfx = trp16cmplx;
  if (blocksize >  7) trpfx = trp08cmplx;
  else                trpfx = trp04cmplx;

    dx = blocksize;
  for (ix = 0; ix < nx; ix += blocksize) {
    if (dx > nx - ix) { dx = nx - ix; trpfx = trp04cmplx; }
    trpfy = trpfx;
    dy = blocksize;
  for (iy = 0; iy < ny; iy += blocksize) {
    if (dy > ny - iy) { dy = ny - iy; trpfy = trp04cmplx; }
    trpfy(dx, dy, mya, &a[ix * mya + 2 * iy],
                  mxb, &b[iy * mxb + 2 * ix]);
  }}
}
